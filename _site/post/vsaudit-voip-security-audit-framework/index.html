<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>vsaudit - VOIP Security Audit Framework</title>
	<meta name="description" content="">
	<meta name="author" content="Federico Fazzi">
	<link rel="stylesheet" href="/assets/app-9aa3a0497cf8b7ed5697ebed051cfe57.css">
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	<link rel="canonical" href="http://deftcode.ninja/post/vsaudit-voip-security-audit-framework/">

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-55598198-1', 'auto');
		ga('send', 'pageview');
	</script>
</head>

<body>
	<button id="toggle" class="standard-width" type="button" data-toggle="collapse">
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
	</button>
	<div class="wrapper">
		<header>
	<h1>DEFTCODE<sup>( 2 )</sup></h1>

	<ul id="navbar">
		<li><a href="http://deftcode.ninja" title="Posts">Posts</a></li>
		<li><a href="http://deftcode.ninja/security" title="Security">Security</a></li>
		<li><a href="http://deftcode.ninja/about" title="About">About</a></li>
	</ul>

	<ul id="social" class="apicos-social-sport">
		
		<li><a href="https://github.com/eurialo" title="Github" target="_blank"><span class="apico apico-github-square"></span></a></li>
		
		
		<li><a href="https://linkedin.com/in/eurialo" title="Linkedin" target="_blank"><span class="apico apico-linkedin-square"></span></a></li>
		
		
		<li><a href="https://twitter.com/federicofazzi" title="Twitter" target="_blank"><span class="apico apico-twitter-square"></span></a></li>
		
		
		<li><a href="https://plus.google.com/+FedericoFazzi" title="Google+" target="_blank"><span class="apico apico-google-plus-square"></span></a></li>
		
		<li><a href="/feed.xml" title="Feed RSS" target="_blank"><span class="apico apico-rss-square"></span></a></li>
	</ul>
	<p>
		<small><a href="https://pgp.mit.edu/pks/lookup?search=0x6D378CAF&op=index&exact=on" title="MIT PGP Public Key Server - 0x6D378CAF" target="_blank">GPG - 2048R/6D378CAF</a></small>
	</p>
</header>
		<section>
		<h1 class="post-title">vsaudit - VOIP Security Audit Framework</h1>
<p class="post-meta">RELEASED IN MONDAY 11, MAY, 2015</p>

<h3 id="description">Description</h3>

<p>The <code>vsaudit</code> is an opensource framework to perform <strong>attacks</strong> to general <strong>voip services</strong>. It allows to <strong>scan</strong> the whole network or single host engaging in the <strong>information gathering</strong> phase, besides it is able to search for most known <strong>vulnerabilities</strong> on the found alive hosts and then try to <strong>exploit</strong> them.</p>

<h3 id="configuration">Configuration</h3>

<p>To start using vsaudit you must install the ‘bundler’ package that will be used to install
the requireds gem dependencies through the Gemfile.</p>

<p>Download directly from the <a href="http://bundler.io/" title="Bundler">Bundler</a> website.</p>

<p>Or install with ‘<strong>gem</strong>’ (ruby package manager) with: </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">deftcode ~ <span class="nv">$ </span>gem install bundler</code></pre></div>

<p>After that the installation has been completed, run (in the directory where is located vsaudit):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">deftcode vsaudit <span class="nv">$ </span>bundle</code></pre></div>

<p>Now you can start vsaudit with:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">deftcode vsaudit <span class="nv">$ </span>ruby vsaudit.rb</code></pre></div>

<h3 id="basic-usage">Basic usage</h3>

<h4 id="environment-commands">Environment commands</h4>

<ul>
  <li>Display the available options that can be set</li>
  <li>List the environment variables</li>
  <li>Get the value of environment variable</li>
  <li>Set or change the environment variables</li>
</ul>

<h4 id="audit-commands">Audit commands</h4>

<ul>
  <li>Check mistakes in the local configuration files</li>
  <li>Scan a local o remote network</li>
  <li>Enumerate the extensions</li>
  <li>Bruteforce extensions</li>
  <li>Get the live network traffic</li>
  <li>Intercept the network traffic by custom bpf</li>
</ul>

<h4 id="informations-commands">Informations commands</h4>

<ul>
  <li>Get informations about modules or address</li>
  <li>Show the report list</li>
  <li>Show the extensions list</li>
</ul>

<h4 id="global-commands">Global commands</h4>

<ul>
  <li>Display the help message</li>
  <li>Quit from the framework</li>
</ul>

<h3 id="environment-commands-1">Environment commands</h3>

<h4 id="display-the-available-options-that-can-be-set">Display the available options that can be set</h4>

<pre><code>vsaudit &gt; help environment

+ ENVIRONMENT COMMANDS:

    Command     Args            Description
    s|set       [key] [value]   Set an environment variable
    g|get       [key]           Get an environment variable value/s
    e|env       -               Display all environment variables


+ ENVIRONMENT VARIABLES:

    Option      Value           Description
    PORT        [*r|5060]       Set port range (default: 5060)
    TIMEOUT     [1|0.5]         Set scanner timeout connect()/recv() (default: 1 seconds)
    THREADS     [1|200]         Set scanner threads limit (default: 50 concurrency)
    TRANSPORT   [udp|tcp]       Set transport for enumeration/bruteforce (default: udp)
    IFACE       [eth0|wlan1]    Indicate which interface use to capture network traffic (default: eth0)
    DUMPHEX     [on|off]        Dump network traffic in hexadecimal (default: off)
    DUMPCLEAN   [on|off]        Clear network traffic skipping unicode frame bytes (default: on)

    * r: range  ex. '0-65535'
</code></pre>

<h4 id="list-the-environment-variables">List the environment variables</h4>

<pre><code>vsaudit &gt; env
-&gt; DUMPCLEAN:   on
-&gt; DUMPHEX:     off
-&gt; IFACE:       any
-&gt; PORT:        5060
-&gt; THREADS:     50
-&gt; TIMEOUT:     1
-&gt; TRANSPORT:   udp
</code></pre>

<h4 id="get-the-value-of-environment-variable">Get the value of environment variable</h4>

<pre><code>vsaudit &gt; get port
-&gt; PORT: 5060
</code></pre>

<h4 id="set-or-change-the-environment-variables">Set or change the environment variables</h4>

<div class="highlight"><pre><code class="language-text" data-lang="text">vsaudit &gt; set port 0-65535
+ setting key: PORT value: 0-65535</code></pre></div>

<h3 id="audit-commands-1">Audit commands</h3>

<h4 id="check-mistakes-in-the-local-configuration-files">Check mistakes in the local configuration files</h4>

<p>In <code>modules/asterisk.rb</code> you can <strong>set</strong> the custom <strong>configuration files</strong> that you <strong>want</strong> vsaudit to <strong>inspect</strong>
and <strong>search</strong> for common <strong>mistakes</strong> through a <strong>regular expressions patterns</strong>. 
You could add or remove configuration files to array named <code>@@services_files</code> with the regex pattern.</p>

<p>Example:</p>

<pre><code>@@services_files = [
    # file to audit.                    # unsecure parameter regex.
    '/etc/asterisk/sip.conf'            =&gt; /^(allow=|allowguest)/,
    '/etc/asterisk/extensions.conf'     =&gt; /^(allow)/
]
</code></pre>

<p>In the example above you can <strong>set</strong> the <strong>filename</strong> with absolute path you want to <strong>inspect</strong> and then you
must <strong>set</strong> the <strong>regular expression</strong> to <strong>match</strong> in file, in this case you <strong>instruct vsaudit</strong> to <strong>grep</strong> the
<code>sip.conf</code> and <strong>search</strong> for configuration <strong>option</strong> that start with <code>allow=</code> or <code>allowguest</code> and the
<code>extensions.conf</code> for just <code>allow=</code> options.</p>

<p>How to use it:</p>

<pre><code>vsaudit &gt; fcheck

    Checking filename:  /etc/asterisk/sip.conf
    regexp to matchs:   (?-mix:^(allow=|allowguest))

    Line 3: un-safe parameter found 'allowguest=no'
    Line 9: un-safe parameter found 'allow=ulaw'

    Checking filename:  /etc/asterisk/extensions.conf
    regexp to matchs:   (?-mix:^(allow))
</code></pre>

<h4 id="scan-a-local-o-remote-network">Scan a local o remote network</h4>

<p>You can <strong>perform</strong> a <strong>port-scan</strong> with <strong>TCP/UDP transport</strong> by <strong>matching</strong> vulnerables <strong>services</strong> with a custom
<strong>regular expression</strong> set in the <code>modules/asterisk.rb</code> module.
In the module you can see the <code>@@services_udp_detect_regex</code> <strong>variable</strong> that <strong>allows</strong> you to <strong>set</strong> the
<strong>regular expression</strong> that will be used next time to <strong>match</strong> the <strong>service banner</strong>.</p>

<p><strong>Note:</strong> these things are the same for TCP transport, but you must use the ‘@@services_tcp_detect_regex’
variable for regular expressions settings.</p>

<p>Example:</p>

<pre><code>@@services_udp_detect_regex = [
    :identifiers    =&gt; /(Server:|User-Agent:)/,
    :methods        =&gt; /Allow:/
]
</code></pre>

<p>In the example above you can set the <strong>identifiers</strong> and <strong>methods</strong>, the <strong>first</strong> is used to <strong>match</strong>
the <strong>service banner</strong>, instead the <strong>last</strong> is used to <strong>match</strong> the available <strong>public methods enabled</strong> in
the service (this is usually referred to Asterisk daemon).</p>

<p>While port-scanning, <strong>vsaudit grep</strong> the service <strong>response</strong> and search for <strong>identifiers</strong> regular
expression, then it checks for allowed methods.</p>

<p>How to use it:</p>

<p>First set port range, this can be a single port or ports range (default: 5060):</p>

<pre><code>vsaudit &gt; set port 5060                 # Scans single port
or
vsaudit &gt; set port 5000-8000            # Scans from port 5000 to 8000
</code></pre>

<p>Optionally you can set the transport (default is set to udp)</p>

<pre><code>vsaudit &gt; set transport tcp             # Sets transport to tcp
</code></pre>

<p>Optionally you can set the timeout value for connect() and recv() calls (default: 0.5):</p>

<pre><code>vsaudit &gt; set timeout 1                 # Sets timeout to 1 seconds
or
vsaudit &gt; set timeout 0.5               # Sets timeout to 0.5 seconds (500 milliseconds)
</code></pre>

<p>Do the network scan:</p>

<pre><code>vsaudit &gt; scan 127.0.0.1

starting scan on address:   127.0.0.1
using ports-range:          5060-5060 (udp)

+ 127.0.0.1        open port udp/5060            Asterisk PBX 11.7.0~dfsg-1ubuntu1


----------------------------------------------------------------------------------------------------------------------
| Device           | Port      | Banner                                   | Allows                                   |
----------------------------------------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
----------------------------------------------------------------------------------------------------------------------
+ Consider to use: i [device] to retrieve full device informations
</code></pre>

<h4 id="enumerate-the-extensions">Enumerate the extensions</h4>

<p>You can starts <strong>enumerating</strong> the <strong>extensions</strong> with explicit <strong>set</strong> a custom <strong>address</strong> or 
<strong>using</strong> the <strong>previous addresses found</strong> through <strong>port-scanner</strong>, then you can <strong>specify</strong> the <strong>extensions range</strong>
or the <strong>file</strong> that can be <strong>used</strong> to <strong>enumerate</strong> it.</p>

<p>How to use it:</p>

<p><strong>Enumerating</strong> using <strong>single target</strong> and <strong>custom ranges</strong>:</p>

<pre><code>vsaudit &gt; en 7000-8000 127.0.0.1

    starting enumeration on address:    127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension '7002' enabled   [no auth]
    + 127.0.0.1:5060         extension '7003' enabled   [no auth]
    &gt; testing extension: 8000                  

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
</code></pre>

<p><strong>Enumerating</strong> using <strong>previous generated report</strong> list and <strong>custom range</strong>:</p>

<pre><code>vsaudit &gt; r

    ----------------------------------------------------------------------------------------------------------------------
    | Device           | Port      | Motd                                     | Allows                                   |
    ----------------------------------------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
    ----------------------------------------------------------------------------------------------------------------------

vsaudit &gt; en 7000-8000

    starting enumeration on address:    127.0.0.1
    using single port:                  5060 (udp)

    + 127.0.0.1:5060         extension '7002' enabled   [no auth]
    + 127.0.0.1:5060         extension '7003' enabled   [no auth]
    &gt; testing extension: 8000

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
</code></pre>

<p><strong>Enumerating</strong> using <strong>single target</strong> and <strong>dictionary</strong> extensions <strong>list</strong>:</p>

<pre><code>vsaudit &gt; enum ext-list 127.0.0.1

    starting enumeration on address:    127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension '7002' enabled   [no auth]
    &gt; testing extension: 3001                  

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
</code></pre>

<p><strong>Note:</strong> you can write your own dictionary lists and locate them in the directory ‘list/’.</p>

<p><strong>Enumerating</strong> using <strong>single target</strong> and <strong>dictionary</strong> extensions <strong>list with password</strong>:</p>

<p>You can append a password to an extension name such as:</p>

<pre><code>    ...
    7000
    7001:~123456
    7002
    7003:~examplepasswd
    ...
</code></pre>

<p>So, when you start <strong>enumerating</strong> address with <strong>dictionary list</strong>, <strong>if</strong> vsaudit <strong>found</strong> the <strong>password</strong> on the <strong>right</strong> of extension
separated by the <strong>separator</strong> <code>:~</code> It will <strong>automatically tries</strong> the <strong>authentication</strong> with the <strong>md5 challenge</strong>.</p>

<h4 id="bruteforce-extensions">Bruteforce extensions</h4>

<p>Here you can try to <strong>bruteforce</strong> the <strong>extensions</strong> with a <strong>password list</strong>.</p>

<p>How to use it:</p>

<pre><code>vsaudit &gt; bf ext-list psw-list 127.0.0.1

    starting bruteforce on address:     127.0.0.1
    using ports-range:                  5060-5060 (udp)

    + 127.0.0.1:5060         extension 7001             password: 123                   
    + 127.0.0.1:5060         extension 7002             password: -                      
    &gt; testing authentication: 3001             : manuelito             
    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
</code></pre>

<p>or</p>

<pre><code>vsaudit &gt; bf 7000-7003 psw-list 0.0.0.0

    starting bruteforce on address:     0.0.0.0
    using ports-range:                  5060-5060 (udp)

    + 0.0.0.0:5060           extension 7001             password: 123                   
    + 0.0.0.0:5060           extension 7002             password: -                      
    + 0.0.0.0:5060           extension 7003             password: -                      

    ------------------------------------------------------------------------------------
    | Device           | Port      | Extension           | Auth | Password             |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7001                | yes  | 123                  |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7002                | no   | -                    |
    ------------------------------------------------------------------------------------
    | 0.0.0.0          | 5060/udp  | 7003                | no   | -                    |
    ------------------------------------------------------------------------------------
</code></pre>

<h4 id="get-the-live-network-traffic">Get the live network traffic</h4>

<p>Here you can <strong>monitor live network traffic</strong> using standard <strong>bpf filter</strong> (<strong>Barkeley Packet Filter</strong>).</p>

<p>How to use it:</p>

<p><strong>Get tcp</strong> or <strong>udp</strong> live network <strong>traffic</strong>:</p>

<pre><code>vsaudit &gt; live

    capturing local network traffic
    using barkeley packet filter:   udp

    Packet length: 631, Time: 2015-04-11 09:45:43
    ---------------------------------------------
    SIP/2.0 401 Unauthorized
    Via: SIP/2.0/UDP 192.168.1.196:5060;branch=z9hG4bKf083b96c-8cde-e411-85f6-000c29bac856;received=192.168.1.196;rport=5060
    From: "pentester" &lt;sip:7001@192.168.1.100&gt;;tag=aa7fb86c-8cde-e411-85f6-000c29bac856
    To: &lt;sip:192.168.1.100&gt;;tag=as54658d12
    Call-ID: 0683b86c-8cde-e411-85f6-000c29bac856@deftcode
    CSeq: 1 INVITE
    Server: Asterisk PBX 11.7.0~dfsg-1ubuntu1
    Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
    Supported: replaces
    WWW-Authenticate: Digest algorithm=MD5, realm="asterisk", nonce="39e13888"
    Content-Length: 0
</code></pre>

<p><strong>Get tcp</strong> or <strong>udp</strong> live network <strong>traffic filtered</strong> by <strong>ip address</strong>:</p>

<pre><code>vsaudit &gt; live [addr]
</code></pre>

<p><strong>Note:</strong> if you want to intercept tcp traffic, you need to set environment variable to ‘tcp’ like: ‘set transport tcp’</p>

<h4 id="intercept-the-network-traffic-by-custom-bpf">Intercept the network traffic by custom bpf</h4>

<p>Here you can <strong>monitor traffic</strong> by using a <strong>custom barkeley packet filter syntax</strong>.</p>

<p>How to use it:</p>

<p><strong>Get</strong> all <strong>udp</strong> network <strong>traffic filtered</strong> by <strong>destination port 5060</strong>:</p>

<pre><code>vsaudit &gt; in udp dst port 5060

    capturing local network traffic
    using barkeley packet filter:   udp dst port 5060

    Packet length: 631, Time: 2015-04-11 09:44:02
    ---------------------------------------------
    SIP/2.0 401 Unauthorized
    Via: SIP/2.0/UDP 192.168.1.196:5060;branch=z9hG4bK5a7cf230-8cde-e411-85f6-000c29bac856;received=192.168.1.196;rport=5060
    From: "pentester" &lt;sip:7001@192.168.1.100&gt;;tag=aeb5f130-8cde-e411-85f6-000c29bac856
    To: &lt;sip:192.168.1.100&gt;;tag=as159ad5f0
    Call-ID: e8b7f130-8cde-e411-85f6-000c29bac856@deftcode
    CSeq: 1 INVITE
    Server: Asterisk PBX 11.7.0~dfsg-1ubuntu1
    Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH
    Supported: replaces
    WWW-Authenticate: Digest algorithm=MD5, realm="asterisk", nonce="6e46f041"
    Content-Length: 0
</code></pre>

<p><strong>Intercept</strong> the <strong>sip md5 challenge</strong> response <strong>hash</strong> (<strong>WWW-Authenticate</strong>):</p>

<p>You can try to intercept the md5 challenge during the sip handshake authentication. </p>

<p>Here is how handshake was performed:</p>

<pre><code>    md5_a = md5(username : realm : password)        # Encode first string.
    md5_b = md5(method : request_uri)               # Encode last string.

    md5_f = md5(md5_a : nonce : md5_b)              # Here is the encoded 'response' hash.
</code></pre>

<p>How to use it:</p>

<pre><code>vsaudit &gt; in password

    capturing local network traffic
    using barkeley packet filter:   udp or tcp

    2015-04-11 19:21:26: Handshake request data
    -------------------------------------------
    WWW-Authenticate: Digest algorithm=MD5
    realm="asterisk"
    nonce="1edf8169"

    2015-04-11 19:21:26: Handshake request data
    -------------------------------------------
    WWW-Authenticate: Digest algorithm=MD5
    realm="asterisk"
    nonce="1edf8169"

    2015-04-11 19:21:26: Found an md5 challenge
    -------------------------------------------
    Authorization: Digest username="7001"
    realm="asterisk"
    nonce="1edf8169"
    uri="sip:192.168.1.100"
    algorithm=MD5
    response="ad711f90b89907efccafcb31db11e034"
</code></pre>

<p><strong>Record</strong> the live <strong>network traffic stream</strong> to <strong>file</strong></p>

<pre><code>vsaudit &gt; in udp portrange 10000-20000 record
</code></pre>

<p>The traffic will be recorded to ./raw/data.raw and action stay in background.</p>

<p><strong>Daemonize</strong> the <strong>intercept process</strong> in a <strong>session</strong></p>

<pre><code>vsaudit &gt; in udp dst port 5060 detach
</code></pre>

<p><strong>Attach</strong> to an <strong>opened session</strong></p>

<p>First <strong>show</strong> the <strong>active sessions</strong>:</p>

<pre><code>    vsaudit &gt; session list

    - session id: 0     intercept detached in progress

    + Use session [session_id] to attach to process
</code></pre>

<p><strong>Use</strong> the session <code>[session-id]</code> to <strong>attach it</strong>, then press <strong>CTRL+C</strong> to <strong>close</strong> the <strong>descriptor and session</strong>:</p>

<pre><code>    vsaudit &gt; session 0

    - session id: 0     intercept detached in progress
    + Packet Capture stopped by interrupt signal.
    0 packets received by filter
    0 packets dropped by kernel
</code></pre>

<h3 id="informations-commands-1">Informations commands</h3>

<h4 id="get-informations-about-modules-or-address">Get informations about modules or address</h4>

<p>Here you can <strong>retrieve</strong> the <strong>informations</strong> about a custom <strong>module</strong> or an <strong>address</strong> located in the report list.</p>

<p>How to use it:</p>

<p><strong>Get module</strong> informations:</p>

<pre><code>vsaudit &gt; info asterisk

Module 'asterisk' found:

+ Name:         Asterisk auditing module v. 2015.1
+ Author:       Federico Fazzi &lt;eurialo@deftcode.ninja&gt;

+ Description:  This is a module that manages the asterisk service like
                service identification and extensions enumeration.
</code></pre>

<p><strong>Get address</strong> informations:</p>

<pre><code>vsaudit &gt; info 127.0.0.1

Address '127.0.0.1' found:

+ Device:   127.0.0.1
+ Port:     5060/udp

+ Motd:     Asterisk PBX 11.7.0~dfsg-1ubuntu1
+ Allows:   INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH

+ Extensions:

------------------------------------------------------------------------------------
| Device           | Port      | Extension           | Auth | Password             |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7002                | no   | -                    |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
------------------------------------------------------------------------------------
</code></pre>

<p><strong>Show</strong> the <strong>report list</strong></p>

<pre><code>vsaudit &gt; report

----------------------------------------------------------------------------------------------------------------------
| Device           | Port      | Banner                                   | Allows                                   |
----------------------------------------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | Asterisk PBX 11.7.0~dfsg-1ubuntu1        | INVITE, ACK, CANCEL, OPTIONS, BYE        |
----------------------------------------------------------------------------------------------------------------------
+ Consider to use: i [device] to retrieve full device informations
</code></pre>

<p><strong>Show</strong> the <strong>extensions list</strong></p>

<pre><code>vsaudit &gt; exts

------------------------------------------------------------------------------------
| Device           | Port      | Extension           | Auth | Password             |
------------------------------------------------------------------------------------
| 127.0.0.1        | 5060/udp  | 7003                | no   | -                    |
------------------------------------------------------------------------------------
</code></pre>

<p><strong>Show</strong> the <strong>active session</strong> list</p>

<pre><code>vsaudit &gt; session list

- session id: 0     intercept detached in progress

+ Use session [session_id] to attach to process
</code></pre>

<p><strong>Decode on-the-fly</strong> the <strong>raw data-file</strong></p>

<p>This command <strong>decodes on-the-fly</strong> the <strong>raw data stream</strong> that is stored in a <strong>file</strong> with <strong>sox library</strong>.
It’s <strong>useful</strong> to <strong>listen</strong> the <strong>voice-call in realtime</strong>.</p>

<pre><code>vsaudit &gt; decode [raw-file]
</code></pre>

<h3 id="global-commands-1">Global commands</h3>

<h4 id="display-the-help-message">Display the help message</h4>

<pre><code>vsaudit &gt; help
or
vsaudit &gt; h [description|environment|audit|filters|informations|global]
</code></pre>

<p>Example:</p>

<pre><code>vsaudit &gt; h

    + DESCRIPTION:

        The vsaudit is an opensource framework to perform attacks to general voip services
        It allows to scans the whole network or single host to do the gathering phase, then 
        it is able to search for most known vulnerabilities on the founds alive hosts and 
        try to exploit them.


    + ENVIRONMENT COMMANDS:

        Command         Args                    Description
        s|set           [key] [value]           Set an environment variable
        g|get           [key]                   Get an environment variable value/s
        e|env           -                       Display all environment variables


    + ENVIRONMENT VARIABLES:

        Option          Value                   Description
        PORT            [*r|5060]               Set port range (default: 5060)
        TIMEOUT         [1|0.5]                 Set scanner timeout connect()/recv() (default: 1 seconds)
        THREADS         [1|200]                 Set scanner threads limit (default: 50 concurrency)
        TRANSPORT       [udp|tcp]               Set transport for enumeration/bruteforce (default: udp)
        IFACE           [eth0|wlan1]            Indicate which interface to use to capture network traffic (default: eth0)
        DUMPHEX         [on|off]                Dump network traffic in hexadecimal (default: off)
        DUMPCLEAN       [on|off]                Clear network traffic skipping unicode frame bytes (default: on)

    * r: range  ex. '0-65535'


    + AUDIT COMMANDS:

        Command         Args                    Description
        f|fcheck        -                       Check for common configurations mistakes
        sn|scan         [addr[/24]]             Start information gathering scanner
        en|enum         [*r|*e] [addr]          Enumerate/Test sip extensions (accounts)
        bf|bruteforce   [*r|*e] [*p] [addr]     Try to bruteforce sip extension(s)

        * r: range  ex. 0500-6000
        * e: ext-file   ex. 'ext-list'
        * p: psw-file   ex. 'psw-list'


    + PCAP BASE FILTERS:

        Filter                                  Description
        udp dst port 5060                       Intercept destination udp traffic to destination port 5060
        tcp port 5060                           Intercept source and destination tcp traffic from source port 5060
        ip host 192.168.1.100                   Intercept source and destination both udp/tcp traffic
        password                                Intercept the sip md5 challenge response hash (WWW-Authenticate)


    + INFO COMMANDS:

        Command         Args                    Description
        i|info          [module|addr]           Return informations about module or address in report list
        r|report        -                       Show scanner report with grouped trasports data
        ex|exts         -                       Show extensions enumeration report
        se|session      [list|session_id]       Show extensions enumeration report
        lv|live         [addr]                  Get all or filtered live network traffic data
        in|intercept    [pcap-filter]           Filter network traffic using pcap filters (live extended)
        dc|decode       [raw-file]              Decode on-the-fly raw data-file stream (listen the voice-call)

        * intercept: append option 'detach' to sessionize action
        * intercept: append option 'record' to save stream to file


    + GLOBAL COMMANDS:

        Command         Args                    Description
        q|quit|exit     -                       Exit
        h|help          [what]                  Display the help messages
                                                description | environment | audit | filters | informations | global
</code></pre>

<h4 id="quit-from-the-framework">Quit from the framework</h4>

<pre><code>vsaudit &gt; exit
or
vsaudit &gt; q
</code></pre>

<h3 id="contribution-and-the-sources">Contribution and the sources</h3>

<p>If you want contribute to the vsaudit project you can start by fork the project in the github repository.</p>

<p><span id="sources-list">
<a href="https://github.com/sanvil/vsaudit/" title="GitHub vsaudit">View on GitHub</a>
<a href="https://github.com/sanvil/vsaudit/archive/master.zip" title="Download vsaudit">Direct Download</a>
</span></p>


<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-538ce0c960e04da4" async></script>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_sharing_toolbox"></div>

<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'deftcode'; // required: replace example with your forum shortname

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</section>
		<footer>
	<p><small>2017 – <b><a href="http://en.wikipedia.org/wiki/MIT_License" title="Wikipedia.org - MIT License" target="_blank">MIT License</a></b></small></p>
</footer>
<script src="/assets/app-cfd2668a2a4934bd07f418c9af7461f6.js"></script>
	</div>
</body>
</html>
